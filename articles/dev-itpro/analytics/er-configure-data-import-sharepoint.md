---
title: Konfigurere dataimport fra SharePoint
description: Dette emnet forklarer hvordan du importerer data fra Microsoft SharePoint.
author: NickSelin
manager: AnnBe
ms.date: 05/21/2018
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.translationtype: HT
ms.sourcegitcommit: 821d8927211d7ac3e479848c7e7bef9f650d4340
ms.openlocfilehash: 9f23f73e9a98fc50c622255bf6ed027c41ec8010
ms.contentlocale: nb-no
ms.lasthandoff: 08/13/2018

---
# <a name="configure-data-import-from-sharepoint"></a><span data-ttu-id="83cb0-103">Konfigurere dataimport fra SharePoint</span><span class="sxs-lookup"><span data-stu-id="83cb0-103">Configure data import from SharePoint</span></span>

[!include[banner](../includes/banner.md)]

<span data-ttu-id="83cb0-104">Hvis du vil importere data fra en innkommende fil ved hjelp av Elektronisk rapportering-rammeverket (ER), må du konfigurere et ER-format som støtter importen, og deretter kjøre en modelltilordning av typen **Til målet** som bruker dette formatet som datakilde.</span><span class="sxs-lookup"><span data-stu-id="83cb0-104">To import data from an incoming file by using the Electronic reporting (ER) framework, you must configure an ER format that supports the import and then run a model mapping of the **To destination** type that uses that format as a data source.</span></span> <span data-ttu-id="83cb0-105">Hvis du vil importere data, må du navigere til filen som du vil importere.</span><span class="sxs-lookup"><span data-stu-id="83cb0-105">To import data, you must navigate to the file that you want to import.</span></span> <span data-ttu-id="83cb0-106">Den innkommende filen kan velges manuelt av brukeren.</span><span class="sxs-lookup"><span data-stu-id="83cb0-106">The incoming file can be manually selected by user.</span></span> <span data-ttu-id="83cb0-107">Med den nye ER-muligheten som støtter import av data fra Microsoft SharePoint, kan denne prosessen konfigureres som den uovervåkede.</span><span class="sxs-lookup"><span data-stu-id="83cb0-107">With the new ER capability to support importing data from Microsoft SharePoint, this process can be configured as the unattended one.</span></span> <span data-ttu-id="83cb0-108">Du kan bruke ER-konfigurasjoner til å utføre dataimport fra filer som er lagret i Microsoft SharePoint-mappene.</span><span class="sxs-lookup"><span data-stu-id="83cb0-108">You can use ER configurations to perform data import from files that are stored in Microsoft SharePoint folders.</span></span> <span data-ttu-id="83cb0-109">Dette emnet forklarer hvordan du fullfører import fra SharePoint til Microsoft Dynamics 365 for Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="83cb0-109">This topic explains how to complete the import from SharePoint to Microsoft Dynamics 365 for Finance and Operations.</span></span> <span data-ttu-id="83cb0-110">Eksemplene bruker leverandørtransaksjoner som forretningsdata.</span><span class="sxs-lookup"><span data-stu-id="83cb0-110">The examples use vendor transactions as business data.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="83cb0-111">Nødvendig programvare</span><span class="sxs-lookup"><span data-stu-id="83cb0-111">Prerequisites</span></span>
<span data-ttu-id="83cb0-112">Hvis du vil fullføre eksemplene i dette emnet, må du ha følgende tilgang:</span><span class="sxs-lookup"><span data-stu-id="83cb0-112">To complete the examples in this topic, you must have the following access:</span></span>

- <span data-ttu-id="83cb0-113">Tilgang til Finance and Operations for én av følgende roller:</span><span class="sxs-lookup"><span data-stu-id="83cb0-113">Access to Finance and Operations for one of the following roles:</span></span>

    - <span data-ttu-id="83cb0-114">Utvikler av elektronisk rapportering</span><span class="sxs-lookup"><span data-stu-id="83cb0-114">Electronic reporting developer</span></span>
    - <span data-ttu-id="83cb0-115">Funksjonell konsulent for elektronisk rapportering</span><span class="sxs-lookup"><span data-stu-id="83cb0-115">Electronic reporting functional consultant</span></span>
    - <span data-ttu-id="83cb0-116">Systemansvarlig</span><span class="sxs-lookup"><span data-stu-id="83cb0-116">System administrator</span></span>

- <span data-ttu-id="83cb0-117">Tilgang til forekomsten av Microsoft SharePoint-serveren som er konfigurert for bruk med Finance and Operations</span><span class="sxs-lookup"><span data-stu-id="83cb0-117">Access to the instance of Microsoft SharePoint Server that is configured for use with Finance and Operations</span></span>
- <span data-ttu-id="83cb0-118">ER-format- og modellkonfigurasjoner for 1099-betalinger</span><span class="sxs-lookup"><span data-stu-id="83cb0-118">ER format and model configurations for 1099 payments</span></span>

### <a name="create-required-er-configurations"></a><span data-ttu-id="83cb0-119">Opprette nødvendige ER-konfigurasjoner</span><span class="sxs-lookup"><span data-stu-id="83cb0-119">Create required ER configurations</span></span>
<span data-ttu-id="83cb0-120">Spill av **ER Importer data fra en Microsoft Excel-fil**-oppgaveveiledningene, som er en del av **7.5.4.3 Anskaffe/utvikle komponenter for IT-tjeneste/-løsning (10677)**-forretningsprosessen.</span><span class="sxs-lookup"><span data-stu-id="83cb0-120">Play the **ER Import data from a Microsoft Excel file** task guides, which are part of the **7.5.4.3 Acquire/Develop IT service/solution components (10677)** business process.</span></span> <span data-ttu-id="83cb0-121">Disse veiledningene forklarer prosessen med å utforme og bruke ER-konfigurasjoner til å interaktivt importere leverandørtransaksjoner fra eksterne Microsoft Excel-filer.</span><span class="sxs-lookup"><span data-stu-id="83cb0-121">These task guides walk you through the process of designing and using ER configurations to interactively import vendor transactions from external Microsoft Excel files.</span></span> <span data-ttu-id="83cb0-122">Hvis du vil ha mer informasjon, se [Analysere innkommende dokumenter i Microsoft Excel](parse-incoming-documents-excel.md).</span><span class="sxs-lookup"><span data-stu-id="83cb0-122">For more information, see [Parse incoming documents in Microsoft Excel](parse-incoming-documents-excel.md).</span></span> <span data-ttu-id="83cb0-123">Til slutt har du:</span><span class="sxs-lookup"><span data-stu-id="83cb0-123">Fianlly, you will have:</span></span>

- <span data-ttu-id="83cb0-124">ER-konfigurasjoner:</span><span class="sxs-lookup"><span data-stu-id="83cb0-124">ER configurations:</span></span>

    - <span data-ttu-id="83cb0-125">ER-modellkonfigurasjon, **1099-betalingsmodell**</span><span class="sxs-lookup"><span data-stu-id="83cb0-125">ER model configuration, **1099 Payments model**</span></span>
    - <span data-ttu-id="83cb0-126">ER-formatkonfigurasjon, **Format for import av leverandørenes transaksjoner fra Excel**</span><span class="sxs-lookup"><span data-stu-id="83cb0-126">ER format configuration, **Format for importing vendors' transactions from Excel**</span></span>

    <span data-ttu-id="83cb0-127">[![ER-konfigurasjoner for å importere data fra SharePoint](./media/GERImportFromSharePoint-01-Configurations.PNG)](./media/GERImportFromSharePoint-01-Configurations.PNG)</span><span class="sxs-lookup"><span data-stu-id="83cb0-127">[![ER configurations for importing data from SharePoint](./media/GERImportFromSharePoint-01-Configurations.PNG)](./media/GERImportFromSharePoint-01-Configurations.PNG)</span></span>

- <span data-ttu-id="83cb0-128">Eksempel på den innkommende filen for dataimport:</span><span class="sxs-lookup"><span data-stu-id="83cb0-128">Sample of the incoming file for data import:</span></span>

    - <span data-ttu-id="83cb0-129">Excel-fil **1099import-data.xlsx**, med leverandørtransaksjonene som skal importeres til Finance and Operations</span><span class="sxs-lookup"><span data-stu-id="83cb0-129">Excel file **1099import-data.xlsx**, with vendor transactions that should be imported into Finance and Operations</span></span>

    <span data-ttu-id="83cb0-130">[![Eksempel på Microsoft Excel-fil for import fra SharePoint](./media/GERImportFromSharePoint-02-Excel.PNG)](./media/GERImportFromSharePoint-02-Excel.PNG)</span><span class="sxs-lookup"><span data-stu-id="83cb0-130">[![Sample Microsoft Excel file for importing from SharePoint](./media/GERImportFromSharePoint-02-Excel.PNG)](./media/GERImportFromSharePoint-02-Excel.PNG)</span></span>

> [!NOTE]
> <span data-ttu-id="83cb0-131">Formatet for import av leverandørtransaksjoner velges som standard modelltilordning.</span><span class="sxs-lookup"><span data-stu-id="83cb0-131">The format for importing vendor transactions is selected as the default model mapping.</span></span> <span data-ttu-id="83cb0-132">Derfor, hvis du kjører en modelltilordning for **1099-betalingsmodell**, og modelltilordning er av typen **Til mål**, kjører modelltilordningen dette formatet for å importere data fra eksterne filer.</span><span class="sxs-lookup"><span data-stu-id="83cb0-132">Therefore, if you run a model mapping of the **1099 Payments model**, and that model mapping is of the **To destination** type, the model mapping runs this format to import data from external files.</span></span> <span data-ttu-id="83cb0-133">Disse dataene brukes deretter til å oppdatere tabeller i programmet.</span><span class="sxs-lookup"><span data-stu-id="83cb0-133">It then uses that data to update application tables.</span></span>

## <a name="configure-document-management-parameters"></a><span data-ttu-id="83cb0-134">Konfigurere parametere for dokumentstyring</span><span class="sxs-lookup"><span data-stu-id="83cb0-134">Configure Document management parameters</span></span>
1. <span data-ttu-id="83cb0-135">På siden **Parametere for dokumentstyring** konfigurerer du tilgang til SharePoint-serverforekomsten som skal brukes av firmaet som du er logget på.</span><span class="sxs-lookup"><span data-stu-id="83cb0-135">On the **Document management parameters** page, configure access to the SharePoint Server instance that will be used by the company that you're currently signed in to.</span></span> <span data-ttu-id="83cb0-136">I dette eksemplet er firmaet USMF.</span><span class="sxs-lookup"><span data-stu-id="83cb0-136">In this example, the company is USMF.</span></span>
2. <span data-ttu-id="83cb0-137">Test tilkoblingen til SharePoint-serverforekomsten for å være sikker på at du har fått tilgang.</span><span class="sxs-lookup"><span data-stu-id="83cb0-137">Test the connection to the SharePoint Server instance to make sure that you've been granted access.</span></span>

    <span data-ttu-id="83cb0-138">[![Innstilling for dokumentadministrasjon – SharePoint-server](./media/GERImportFromSharePoint-03-SharePointSetup.png)](./media/GERImportFromSharePoint-03-SharePointSetup.png)</span><span class="sxs-lookup"><span data-stu-id="83cb0-138">[![Document management setting – SharePoint server](./media/GERImportFromSharePoint-03-SharePointSetup.png)](./media/GERImportFromSharePoint-03-SharePointSetup.png)</span></span>

3. <span data-ttu-id="83cb0-139">Åpne det konfigurerte SharePoint-området, og opprett de følgende mappene der de innkommende filene kan lagres:</span><span class="sxs-lookup"><span data-stu-id="83cb0-139">Open the configured SharePoint site, and create the following folders where the incoming files can be stored:</span></span>

    - <span data-ttu-id="83cb0-140">Kilde for import av filer (hoved)</span><span class="sxs-lookup"><span data-stu-id="83cb0-140">Files import source (main)</span></span>
    - <span data-ttu-id="83cb0-141">Kilde for import av filer (alternativ)</span><span class="sxs-lookup"><span data-stu-id="83cb0-141">Files import source (alternative)</span></span>

    <span data-ttu-id="83cb0-142">[![Innstilling for dokumentadministrasjon – SharePoint-server](./media/GERImportFromSharePoint-04-SharePointFolder1.png)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)</span><span class="sxs-lookup"><span data-stu-id="83cb0-142">[![Document management setting – SharePoint server](./media/GERImportFromSharePoint-04-SharePointFolder1.png)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)</span></span>

    <span data-ttu-id="83cb0-143">[![Innstilling for dokumentadministrasjon – SharePoint-server](./media/GERImportFromSharePoint-05-SharePointFolder2.png)](./media/GERImportFromSharePoint-05-SharePointFolder2.png)</span><span class="sxs-lookup"><span data-stu-id="83cb0-143">[![Document management setting – SharePoint server](./media/GERImportFromSharePoint-05-SharePointFolder2.png)](./media/GERImportFromSharePoint-05-SharePointFolder2.png)</span></span>

4. <span data-ttu-id="83cb0-144">På **Dokumenttyper**-siden i Finance and Operations kan du opprette følgende dokumenttyper som skal brukes for å få tilgang til SharePoint-mappene du nettopp opprettet.</span><span class="sxs-lookup"><span data-stu-id="83cb0-144">In Finance and Operations, on the **Document types** page, create the following document types that will be used to access the SharePoint folders that you just created:</span></span>

    - <span data-ttu-id="83cb0-145">SP hoved</span><span class="sxs-lookup"><span data-stu-id="83cb0-145">SP Main</span></span>
    - <span data-ttu-id="83cb0-146">SP alternativ</span><span class="sxs-lookup"><span data-stu-id="83cb0-146">SP Alternative</span></span>

5. <span data-ttu-id="83cb0-147">For opprettede dokumenttyper, i **Gruppe**-feltet angir du **Fil** og i **Plassering**-feltet angir du **SharePoint**.</span><span class="sxs-lookup"><span data-stu-id="83cb0-147">For created document types, in the **Group** field, enter **File** and in the **Location** field, enter **SharePoint**.</span></span> <span data-ttu-id="83cb0-148">Skriv inn adressen til SharePoint-mappen:</span><span class="sxs-lookup"><span data-stu-id="83cb0-148">Then enter the address of the SharePoint folder:</span></span>

    - <span data-ttu-id="83cb0-149">For **SP hoved**-dokumenttype: Kilde for import av filer (hoved)</span><span class="sxs-lookup"><span data-stu-id="83cb0-149">For the **SP Main** document type: Files import source (main)</span></span>
    - <span data-ttu-id="83cb0-150">For **SP alternativ**-dokumenttype: Kilde for import av filer (alternativ)</span><span class="sxs-lookup"><span data-stu-id="83cb0-150">For the **SP Alternative** document type: Files import source (alternative)</span></span>

    <span data-ttu-id="83cb0-151">[![SharePoint-innstilling – ny dokumenttype](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)</span><span class="sxs-lookup"><span data-stu-id="83cb0-151">[![SharePoint setting – new document type](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)</span></span>

## <a name="configure-er-sources-for-the-er-format"></a><span data-ttu-id="83cb0-152">Konfigurere ER-kildene for ER-formatet</span><span class="sxs-lookup"><span data-stu-id="83cb0-152">Configure ER sources for the ER format</span></span>
1. <span data-ttu-id="83cb0-153">Klikk på **Organisasjonsstyring** \> **Elektronisk rapportering** \> **Kilde for elektronisk rapportering**.</span><span class="sxs-lookup"><span data-stu-id="83cb0-153">Click **Organization administration** \> **Electronic reporting** \> **Electronic reporting source**.</span></span>
2. <span data-ttu-id="83cb0-154">På **Kilde for elektronisk rapportering**-siden konfigurer kildefilene for dataimport ved å bruke et konfigurert ER-format.</span><span class="sxs-lookup"><span data-stu-id="83cb0-154">On the **Electronic reporting source** page, configure the source files for data import by using the configured ER format.</span></span>
3. <span data-ttu-id="83cb0-155">Definer en filnavnmaske, slik at bare XLSX-filer importeres.</span><span class="sxs-lookup"><span data-stu-id="83cb0-155">Define a file name mask, so that only files with the .xlsx extension are imported.</span></span> <span data-ttu-id="83cb0-156">Filnavnmasken er valgfri og brukes bare når den er definert.</span><span class="sxs-lookup"><span data-stu-id="83cb0-156">The file name mask is optional and is used only when it has been defined.</span></span> <span data-ttu-id="83cb0-157">Du kan bare definere én maske for hvert ER-format.</span><span class="sxs-lookup"><span data-stu-id="83cb0-157">You can define only one mask for each ER format.</span></span>
4. <span data-ttu-id="83cb0-158">Velg begge SharePoint-mappene du opprettet tidligere.</span><span class="sxs-lookup"><span data-stu-id="83cb0-158">Select both SharePoint folders that you created earlier.</span></span>

    <span data-ttu-id="83cb0-159">[![Innstilling for ER-filkilde](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span><span class="sxs-lookup"><span data-stu-id="83cb0-159">[![ER files source setting](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span></span>

> [!NOTE]
> - <span data-ttu-id="83cb0-160">*Kilden* for ER defineres for hvert programselskap individuelt.</span><span class="sxs-lookup"><span data-stu-id="83cb0-160">The ER *source* is defined for each application company individually.</span></span> <span data-ttu-id="83cb0-161">*Konfigurasjoner* for ER deles derimot på tvers av firmaer.</span><span class="sxs-lookup"><span data-stu-id="83cb0-161">By contrast, ER *configurations* are shared across companies.</span></span>
> - <span data-ttu-id="83cb0-162">Når du sletter en ER-kildeinnstilling for et ER-format, slettes også alle tilkoblede filtilstandene (se nedenfor).</span><span class="sxs-lookup"><span data-stu-id="83cb0-162">When you delete an ER source setting for an ER format, all connected file states (see below) are also deleted.</span></span>

## <a name="review-the-files-states-for-the-er-format"></a><span data-ttu-id="83cb0-163">Gå gjennom filtilstandene for ER-formatene</span><span class="sxs-lookup"><span data-stu-id="83cb0-163">Review the files states for the ER format</span></span>
1. <span data-ttu-id="83cb0-164">På siden **Elektronisk rapporteringskilde** velger du **Filtilstander for kildene** for å se gjennom innholdet i de konfigurerte filkildene for gjeldende ER-format.</span><span class="sxs-lookup"><span data-stu-id="83cb0-164">On the **Electronic reporting source** page, select **File states for the sources** to review the content of the configured file sources for the current ER format.</span></span>
2. <span data-ttu-id="83cb0-165">I **Filer**-delen kan du se gjennom listen over filer.</span><span class="sxs-lookup"><span data-stu-id="83cb0-165">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="83cb0-166">Denne listen viser følgende:</span><span class="sxs-lookup"><span data-stu-id="83cb0-166">This list presents the following:</span></span>

    - <span data-ttu-id="83cb0-167">Kildefiler som er nødvendige, basert på filnavnmasken (hvis en filnavnmaske er definert), og som er klar for dataimport.</span><span class="sxs-lookup"><span data-stu-id="83cb0-167">Source files that are applicable, based on the file name mask (if a file name mask is defined), and that are ready for data import.</span></span> <span data-ttu-id="83cb0-168">For disse filene er delen **Kildelogger for importformatet** tom.</span><span class="sxs-lookup"><span data-stu-id="83cb0-168">For these files, the **Sources log for the import format** section is blank.</span></span>
    - <span data-ttu-id="83cb0-169">Tidligere importerte filer.</span><span class="sxs-lookup"><span data-stu-id="83cb0-169">Previously imported files.</span></span> <span data-ttu-id="83cb0-170">For hver av disse filene kan du se gjennom loggen for import av denne filen, i **Kildelogger for importformatet**-delen.</span><span class="sxs-lookup"><span data-stu-id="83cb0-170">For each of these files, in the **Sources log for the import format** section, you can review the history of import of this file.</span></span>

<span data-ttu-id="83cb0-171">Du kan også åpne siden **Filtilstander for kildene** ved å velge **Organisasjonsstyring** \> **Elektronisk rapportering** \> **Filtilstander for kildene**.</span><span class="sxs-lookup"><span data-stu-id="83cb0-171">You can also open the **File states for the sources** page by selecting **Organization administration** \> **Electronic reporting** \> **File states for the sources**.</span></span> <span data-ttu-id="83cb0-172">I dette tilfellet gir siden informasjon om filkilder for alle ER-formater som filkilder er konfigurert for, i firmaet som du er logget på.</span><span class="sxs-lookup"><span data-stu-id="83cb0-172">In this case, the page provides information about file sources for all ER formats that file sources have been configured for in the company that you're currently signed in to.</span></span>

## <a name="import-data-from-excel-files-that-are-in-a-sharepoint-folder"></a><span data-ttu-id="83cb0-173">Importere data fra Excel-filer som er i en SharePoint-mappe</span><span class="sxs-lookup"><span data-stu-id="83cb0-173">Import data from Excel files that are in a SharePoint folder</span></span>
1. <span data-ttu-id="83cb0-174">I SharePoint last opp Microsoft Excel-filen **1099import-data.xlsx** som inneholder leverandørtransaksjonene til **Kilde for import av filer (hoved)**-SharePoint-mappen som du opprettet tidligere.</span><span class="sxs-lookup"><span data-stu-id="83cb0-174">In SharePoint, upload the Microsoft Excel file **1099import-data.xlsx** that contains vendor transactions to the **Files import source (main)** SharePoint folder that you created earlier.</span></span>

    <span data-ttu-id="83cb0-175">[![SharePoint-innhold – Microsoft Excel-fil for import](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span><span class="sxs-lookup"><span data-stu-id="83cb0-175">[![SharePoint content – Microsoft Excel file for importing](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span></span>

2. <span data-ttu-id="83cb0-176">I Finance and Operations, på siden **Filtilstander for kildene**, velger du **Oppdater** for å oppdatere siden.</span><span class="sxs-lookup"><span data-stu-id="83cb0-176">In Finance and Operations, on the **File states for the sources** page, select **Refresh** to refresh the page.</span></span> <span data-ttu-id="83cb0-177">Legg merke til at Excel-filen som ble lastet opp til SharePoint, ble vist i dette skjemaet med statusen **Klar**.</span><span class="sxs-lookup"><span data-stu-id="83cb0-177">Note that the Excel file that was uploaded to SharePoint appeared in this form with the status **Ready**.</span></span> <span data-ttu-id="83cb0-178">Følgende statuser støttes for øyeblikket:</span><span class="sxs-lookup"><span data-stu-id="83cb0-178">The following statuses are currently supported:</span></span>

    - <span data-ttu-id="83cb0-179">**Klar** – Tilordnes automatisk for hver ny fil i en SharePoint-mappe.</span><span class="sxs-lookup"><span data-stu-id="83cb0-179">**Ready** – Assigned automatically for each new file in a SharePoint folder.</span></span> <span data-ttu-id="83cb0-180">Denne statusen betyr at filen er klar for import.</span><span class="sxs-lookup"><span data-stu-id="83cb0-180">This status means that the file is ready for import.</span></span>
    - <span data-ttu-id="83cb0-181">**Importerer** – Tilordnet automatisk av en ER-rapport når filen blir låst av importprosessen for å forhindre at den brukes av andre prosesser (hvis mange kjøres samtidig).</span><span class="sxs-lookup"><span data-stu-id="83cb0-181">**Importing** – Assigned automatically by an ER report when the file will be locked by the import process to prevent its usage by other processes (if many of them are running simultaneously).</span></span>
    - <span data-ttu-id="83cb0-182">**Importert** – Tilordnet automatisk av en ER-rapport når filimporten er fullført.</span><span class="sxs-lookup"><span data-stu-id="83cb0-182">**Imported** – Assigned automatically by an ER report when the file import is successfully completed.</span></span> <span data-ttu-id="83cb0-183">Denne statusen betyr at den importerte filen er slettet fra den konfigurerte filkilden (SharePoint-mappe).</span><span class="sxs-lookup"><span data-stu-id="83cb0-183">This status means that the imported file has been deleted from the configured files source (SharePoint folder).</span></span>
    - <span data-ttu-id="83cb0-184">**Mislykket** – Tilordnet automatisk av en ER-rapport når filimporten er fullført med feil eller unntak.</span><span class="sxs-lookup"><span data-stu-id="83cb0-184">**Failed** – Assigned automatically by an ER report when the file import completed with errors or exceptions.</span></span>
    - <span data-ttu-id="83cb0-185">**På vent** – Tilordnet manuelt av brukeren i dette skjemaet.</span><span class="sxs-lookup"><span data-stu-id="83cb0-185">**On hold** – Assigned manually by user on this form.</span></span> <span data-ttu-id="83cb0-186">Denne statusen betyr at filen ikke blir importert for øyeblikket.</span><span class="sxs-lookup"><span data-stu-id="83cb0-186">This status means that the file will not be imported for now.</span></span> <span data-ttu-id="83cb0-187">Denne statusen kan brukes til å utsette importen av noen filer.</span><span class="sxs-lookup"><span data-stu-id="83cb0-187">This status can be used to postpone the import of some files.</span></span>

    <span data-ttu-id="83cb0-188">[![Siden for ER-filtilstand for de valgte kildene](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span><span class="sxs-lookup"><span data-stu-id="83cb0-188">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span></span>

## <a name="import-data-from-sharepoint-files"></a><span data-ttu-id="83cb0-189">Importer data fra SharePoint-filer</span><span class="sxs-lookup"><span data-stu-id="83cb0-189">Import data from SharePoint files</span></span>
1. <span data-ttu-id="83cb0-190">Åpne ER-konfigurasjonstreet, velg **1099-betalingsmodellen**, og utvid listen over ER-modellkomponenter.</span><span class="sxs-lookup"><span data-stu-id="83cb0-190">Open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
2. <span data-ttu-id="83cb0-191">Velg navnet på modelltilordningen for å åpne listen over modelltilordninger av den valgte ER-modellkonfigurasjonen.</span><span class="sxs-lookup"><span data-stu-id="83cb0-191">Select the name of the model mapping to open the list of model mappings of the selected ER model configuration.</span></span>

    <span data-ttu-id="83cb0-192">[![Siden for ER-filtilstand for de valgte kildene](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="83cb0-192">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span></span>

3. <span data-ttu-id="83cb0-193">Velg **Kjør** for å kjøre den valgte modelltilordningen.</span><span class="sxs-lookup"><span data-stu-id="83cb0-193">Select **Run** to run the selected model mapping.</span></span> <span data-ttu-id="83cb0-194">Fordi du har konfigurert filkilder for ER-formatet, kan du endre innstillingen for **Filkilde**-alternativet etter behov.</span><span class="sxs-lookup"><span data-stu-id="83cb0-194">Because you configured file sources for the ER format, you can change the setting of the **File source** option as you require.</span></span> <span data-ttu-id="83cb0-195">Hvis du beholder innstillingen for dette alternativet, importeres XSLX-filene fra de konfigurerte kildene (SharePoint-mappene i dette eksemplet).</span><span class="sxs-lookup"><span data-stu-id="83cb0-195">If you keep the setting of this option, the .xslx files are imported from the configured sources (the SharePoint folders, in this example).</span></span>

    <span data-ttu-id="83cb0-196">I dette eksemplet skal du importere bare én fil.</span><span class="sxs-lookup"><span data-stu-id="83cb0-196">In this example, you're importing only one file.</span></span> <span data-ttu-id="83cb0-197">Hvis det finnes flere filer, velges de for import i rekkefølgen de ble lagt til i SharePoint-mappen.</span><span class="sxs-lookup"><span data-stu-id="83cb0-197">However, if there are multiple files, they are selected for importing in the order in which they were added to the SharePoint folder.</span></span> <span data-ttu-id="83cb0-198">Hver kjøring av et ER-format importerer én enkelt valgt fil.</span><span class="sxs-lookup"><span data-stu-id="83cb0-198">Every run of an ER format imports a single selected file.</span></span>

    <span data-ttu-id="83cb0-199">[![Kjør ER-modelltilordning](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="83cb0-199">[![Run ER model mapping](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span></span>

4. <span data-ttu-id="83cb0-200">Modelltilordningen kan kjøres uovervåket i satsvis modus.</span><span class="sxs-lookup"><span data-stu-id="83cb0-200">The model mapping can run unattended in batch mode.</span></span> <span data-ttu-id="83cb0-201">I dette tilfellet vil en enkelt fil importeres fra de konfigurerte filkildene hver gang et parti kjører dette ER-formatet.</span><span class="sxs-lookup"><span data-stu-id="83cb0-201">In this case, every time that a batch runs this ER format, a single file is imported from the configured file sources.</span></span> <span data-ttu-id="83cb0-202">Bruk følgende kode for å implementere denne partikjøringen.</span><span class="sxs-lookup"><span data-stu-id="83cb0-202">Use the following code to implement this batch run.</span></span>

    ```
    ERObjectsFactory::createMappingDestinationRunByImportFormatMappingId().run()
    ```

    <span data-ttu-id="83cb0-203">Når en fil er importert fra SharePoint-mappen, slettes den fra denne mappen.</span><span class="sxs-lookup"><span data-stu-id="83cb0-203">When a file is successfully imported from the SharePoint folder, it's deleted from that folder.</span></span>

5. <span data-ttu-id="83cb0-204">Angi bilags-ID-en, for eksempel **V-00001**, og velg deretter **OK**.</span><span class="sxs-lookup"><span data-stu-id="83cb0-204">Enter the voucher ID, such as **V-00001**, and then select **OK**.</span></span>

    <span data-ttu-id="83cb0-205">[![Kjør ER-modelltilordning](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="83cb0-205">[![Run ER model mapping](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span></span>

6. <span data-ttu-id="83cb0-206">På siden **Filtilstander for kildene** velger du **Oppdater** for å oppdatere siden.</span><span class="sxs-lookup"><span data-stu-id="83cb0-206">On the **File states for the sources** page, select **Refresh** to refresh the page.</span></span>

    <span data-ttu-id="83cb0-207">[![Siden for ER-filtilstand for de valgte kildene](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="83cb0-207">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span></span>

7. <span data-ttu-id="83cb0-208">I **Filer**-delen kan du se gjennom listen over filer.</span><span class="sxs-lookup"><span data-stu-id="83cb0-208">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="83cb0-209">Delen **Kildelogger for importformatet** inneholder loggen for Excel-filimporten.</span><span class="sxs-lookup"><span data-stu-id="83cb0-209">The **Sources log for the import format** section provides the history of the Excel file import.</span></span> <span data-ttu-id="83cb0-210">Fordi denne filen ble importert, er den merket som **Slettet** i SharePoint-mappen.</span><span class="sxs-lookup"><span data-stu-id="83cb0-210">Because this file was successfully imported, it's marked as **Deleted** in the SharePoint folder.</span></span>
8. <span data-ttu-id="83cb0-211">Gå gjennom SharePoint-mappen **Kilde for import av filer (hoved)**.</span><span class="sxs-lookup"><span data-stu-id="83cb0-211">Review the **Files import source (main)** SharePoint folder.</span></span> <span data-ttu-id="83cb0-212">Excel-filene som ble importert, er slettet fra denne mappen.</span><span class="sxs-lookup"><span data-stu-id="83cb0-212">The Excel files that were successfully imported have been deleted from this folder.</span></span>
9. <span data-ttu-id="83cb0-213">I Finance and Operations velger du **Leverandører** \> **Periodiske oppgaver** \> **Avgift 1099** \> **Leverandørutligning for 1099-skjema**.</span><span class="sxs-lookup"><span data-stu-id="83cb0-213">In Finance and Operations, select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**.</span></span>
10. <span data-ttu-id="83cb0-214">I **Fra-dato** og **Til-dato** angir du riktige verdier.</span><span class="sxs-lookup"><span data-stu-id="83cb0-214">In the **From date** and **To date** fields, enter appropriate values.</span></span> <span data-ttu-id="83cb0-215">Velg deretter **Manuelle 1099-transaksjoner**.</span><span class="sxs-lookup"><span data-stu-id="83cb0-215">Then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="83cb0-216">Leverandørtransaksjonene som ble importert fra Excel-filene i SharePoint for bilaget **V-00001**, vises på siden.</span><span class="sxs-lookup"><span data-stu-id="83cb0-216">The vendor transactions that were imported from the Excel files on SharePoint for voucher **V-00001**, are presented on the page.</span></span>

    <span data-ttu-id="83cb0-217">[![Siden for 1099-leverandørtransaksjoner](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span><span class="sxs-lookup"><span data-stu-id="83cb0-217">[![1099 vendor transactions page](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span></span>

## <a name="prepare-an-excel-file-for-import"></a><span data-ttu-id="83cb0-218">Klargjøre en Excel-fil for import</span><span class="sxs-lookup"><span data-stu-id="83cb0-218">Prepare an Excel file for import</span></span>
1. <span data-ttu-id="83cb0-219">Åpne Excel-filen som du har brukt tidligere.</span><span class="sxs-lookup"><span data-stu-id="83cb0-219">Open the Excel file that you previously used.</span></span> <span data-ttu-id="83cb0-220">I rad 3 kolonne 1 kan du legge til en leverandørkode som ikke finnes i programmet.</span><span class="sxs-lookup"><span data-stu-id="83cb0-220">In row 3 column 1, add a vendor code that doesn't exist in the application.</span></span> <span data-ttu-id="83cb0-221">Legge til mer usann leverandørinformasjon i raden.</span><span class="sxs-lookup"><span data-stu-id="83cb0-221">Add additional false vendor information to the row.</span></span>

    <span data-ttu-id="83cb0-222">[![Eksempel på Microsoft Excel-fil for import fra SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span><span class="sxs-lookup"><span data-stu-id="83cb0-222">[![Sample Microsoft Excel file for importing from SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span></span>

2. <span data-ttu-id="83cb0-223">Last opp den oppdaterte Excel-filen som inneholder leverandørtransaksjoner til SharePoint-mappen **Kilde for import av filer (hoved)** .</span><span class="sxs-lookup"><span data-stu-id="83cb0-223">Upload the updated Excel file that contains vendors transactions to the **Files import source (main)** SharePoint folder.</span></span>
3. <span data-ttu-id="83cb0-224">I Finance and Operations åpne ER-konfigurasjonstreet, velg **1099-betalingsmodellen**, og utvid listen over ER-modellkomponenter.</span><span class="sxs-lookup"><span data-stu-id="83cb0-224">In Finance and Operations, open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
4. <span data-ttu-id="83cb0-225">Velg navnet på modelltilordningen for å oppdatere modelltilordning, slik at leverandørkoden som er feil, regnes som en feil under import av data.</span><span class="sxs-lookup"><span data-stu-id="83cb0-225">Select the name of the model mapping to update the model mapping so that the incorrect vendor code is considered an error during the data import process.</span></span>
5. <span data-ttu-id="83cb0-226">Velg **Utforming**.</span><span class="sxs-lookup"><span data-stu-id="83cb0-226">Select **Designer**.</span></span>
6. <span data-ttu-id="83cb0-227">I **Valideringer**-kategorien må du endre ettervalideringshandlingen for valideringsregelen som er konfigurert for å vurdere om leverandørkontoen som importeres, finnes i programmet.</span><span class="sxs-lookup"><span data-stu-id="83cb0-227">On the **Validations** tab, you must change the post-validation action for the validation rule that was configured to evaluate whether the vendor account that is imported exists in the application.</span></span> <span data-ttu-id="83cb0-228">Oppdater verdien av feltet **Ettervalideringshandling** for å **Stoppe utførelse**, lagre endringene, og lukk siden.</span><span class="sxs-lookup"><span data-stu-id="83cb0-228">Update the value of the **Post-validation action** field to **Stop execution**, save your changes, and close the page.</span></span>

    <span data-ttu-id="83cb0-229">[![Siden ER-utforming av modelltilordning](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="83cb0-229">[![ER model mapping designer page](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span></span>

7. <span data-ttu-id="83cb0-230">Lagre endringene, og lukk ER-utformingen av modelltilordningen.</span><span class="sxs-lookup"><span data-stu-id="83cb0-230">Save your changes, and close the ER model mapping designer.</span></span>
8. <span data-ttu-id="83cb0-231">Velg **Kjør** for å kjøre den endrede ER-modelltilordningen.</span><span class="sxs-lookup"><span data-stu-id="83cb0-231">Select **Run** to run the modified ER model mapping.</span></span>
9. <span data-ttu-id="83cb0-232">Angi bilags-ID-en, for eksempel **V-00002**, og velg deretter **OK**.</span><span class="sxs-lookup"><span data-stu-id="83cb0-232">Enter the voucher ID, such as **V-00002**, and then select **OK**.</span></span>

    <span data-ttu-id="83cb0-233">Legg merke til at infologgen inneholder varslingen som informerer om det som finnes i mappen for SharePoint-fil, inneholder ugyldig leverandørkonto og ikke kan importeres.</span><span class="sxs-lookup"><span data-stu-id="83cb0-233">Note that the Infolog contains the notification informing that residing in SharePoint folder file contains incorrect vendor account and can’t be imported.</span></span>

    <span data-ttu-id="83cb0-234">[![Kjør ER-modelltilordning](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="83cb0-234">[![Run ER model mapping](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span></span>

10. <span data-ttu-id="83cb0-235">På siden **Filtilstander for kildene** velger du **Oppdater**, og deretter, i **Filer**-delen, ser du gjennom fillisten.</span><span class="sxs-lookup"><span data-stu-id="83cb0-235">On the **File states for the sources** page, select **Refresh**, and then, in the **Files** section, review the list of files.</span></span>

    <span data-ttu-id="83cb0-236">[![Siden for ER-filtilstand for de valgte kildene](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="83cb0-236">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span></span>

    <span data-ttu-id="83cb0-237">**Kildelogger for importformatet**-delen angir at importprosessen mislyktes, og at filen fremdeles er i mappen SharePoint (**Er slettet**-boksen er ikke avmerket).</span><span class="sxs-lookup"><span data-stu-id="83cb0-237">The **Sources log for the import format** section indicates that the import process failed and that the file is still in the SharePoint folder (the **Is deleted** checkbox is not selected).</span></span> <span data-ttu-id="83cb0-238">Hvis du vil reparere denne filen i SharePoint ved å legge til den riktige leverandørkoden og deretter endre statusen for filen fra **Mislykket** til **Klar** i **Kildelogger for importformatet**-delen, kan du importere filen på nytt.</span><span class="sxs-lookup"><span data-stu-id="83cb0-238">If you fix this file on SharePoint by adding the proper vendor code and then change the status of the file from **Failed** to **Ready** in the **Sources log for the import format** section, you can import the file again.</span></span>

11. <span data-ttu-id="83cb0-239">Gå gjennom SharePoint-mappen **Kilde for import av filer (hoved)**.</span><span class="sxs-lookup"><span data-stu-id="83cb0-239">Review the **Files import source (main)** SharePoint folder.</span></span> <span data-ttu-id="83cb0-240">Legg merke til at Excel-filen som ikke ble importert, fremdeles er i denne mappen.</span><span class="sxs-lookup"><span data-stu-id="83cb0-240">Notice that the Excel file that wasn't imported is still in this folder.</span></span>
12. <span data-ttu-id="83cb0-241">I Finance and Operations velger du **Leverandører** \> **Periodiske oppgaver** \> **Avgift 1099** \> **Leverandørutligning for 1099-skjema**, skriv inn riktige verdier i **Fra dato**- og **Til dato**-feltene, og velg deretter **Manuelle 1099-transaksjoner**.</span><span class="sxs-lookup"><span data-stu-id="83cb0-241">In Finance and Operations, select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**, enter appropriate values in the **From date** and **To date** fields, and then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="83cb0-242">Bare transaksjoner for bilaget V-00001 er tilgjengelige.</span><span class="sxs-lookup"><span data-stu-id="83cb0-242">Only transactions for voucher V-00001 are available.</span></span> <span data-ttu-id="83cb0-243">Det finnes ingen transaksjoner for bilaget V-00002, selv om feilen for den sist importerte transaksjonen ble funnet i Excel-filen.</span><span class="sxs-lookup"><span data-stu-id="83cb0-243">No transactions for voucher V-00002 are available even though the error for the last imported transaction has been found in the Excel file.</span></span>

