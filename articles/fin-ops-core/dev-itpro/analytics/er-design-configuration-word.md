---
title: Utforme en ny ER-konfigurasjon for å generere rapporter i Word-format
description: Dette emnet forklarer hvordan brukere kan konfigurere et nytt ER-format (Elektronisk rapportering) for å generere rapporter som Microsoft Word-dokumenter.
author: NickSelin
manager: AnnBe
ms.date: 12/17/2020
ms.topic: business-process
ms.prod: ''
ms.technology: ''
ms.search.form: ERWorkspace, ERSolutionTable, EROperationDesigner,  LedgerJournalTable, LedgerJournalTransVendPaym
audience: Application User
ms.reviewer: kfend
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2020-01-01
ms.dyn365.ops.version: Version 10.0.6
ms.openlocfilehash: 563807599d3604079ea08d2b27e354f60e7eaa8a
ms.sourcegitcommit: 6cb174d1ec8b55946dca4db03d6a3c3f4c6fa2df
ms.translationtype: HT
ms.contentlocale: nb-NO
ms.lasthandoff: 03/09/2021
ms.locfileid: "5562100"
---
# <a name="design-a-new-er-configuration-to-generate-reports-in-word-format"></a><span data-ttu-id="d3ea9-103">Utforme en ny ER-konfigurasjon for å generere rapporter i Word-format</span><span class="sxs-lookup"><span data-stu-id="d3ea9-103">Design a new ER configuration to generate reports in Word format</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="d3ea9-104">Hvis du vil generere rapporter som Microsoft Word-dokumenter, må du utforme en mal for rapportene, for eksempel ved å bruke skrivebordsversjonen av Word.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-104">To generate reports as Microsoft Word documents, you must design a template for the reports by using, for example, the Word desktop application.</span></span> <span data-ttu-id="d3ea9-105">Illustrasjonen nedenfor viser eksempelmalen for kontrollrapporten som kan genereres for å vise detaljer om behandlede leverandørbetalinger.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-105">The following illustration shows the sample template for the control report that can be generated to show details of processed vendor payments.</span></span>

![Eksempelmal for kontrollrapporten i skrivebordsversjonen av Word](./media/er-design-configuration-word-image1.png)

<span data-ttu-id="d3ea9-107">Hvis du vil bruke et Word-dokument som en mal for rapporter i Word-format, kan du konfigurere en ny [løsning](er-quick-start1-new-solution.md) for [Elektronisk rapportering (ER)](general-electronic-reporting.md).</span><span class="sxs-lookup"><span data-stu-id="d3ea9-107">To use a Word document as a template for reports in Word format, you can configure a new [Electronic reporting (ER)](general-electronic-reporting.md) [solution](er-quick-start1-new-solution.md).</span></span> <span data-ttu-id="d3ea9-108">Denne løsningen må inneholde en ER-[konfigurasjon](general-electronic-reporting.md#Configuration) som inneholder en komponent for ER-[format](general-electronic-reporting.md#FormatComponentOutbound).</span><span class="sxs-lookup"><span data-stu-id="d3ea9-108">This solution must include an ER [configuration](general-electronic-reporting.md#Configuration) that contains an ER [format](general-electronic-reporting.md#FormatComponentOutbound) component.</span></span>

> [!NOTE]
> <span data-ttu-id="d3ea9-109">Når du oppretter en ny ER-formatkonfigurasjon for å generere rapporter i Word-format, må du enten velge **Word** som formattype i rullegardinboksen **Opprett konfigurasjon** eller la **Formattype**-feltet stå tomt.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-109">When you create a new ER format configuration to generate reports in Word format, you must either select **Word** as the format type in the **Create configuration** drop-down dialog box or leave the **Format type** field blank.</span></span>

![Opprette en formatkonfigurasjon på Konfigurasjoner-siden](./media/er-design-configuration-word-image2.gif)

<span data-ttu-id="d3ea9-111">Er-formatkomponenten for løsningen må inneholde formatelementet **Excel\\Fil**, og dette formatelementet må være koblet til Word-dokumentet som skal brukes som mal for genererte rapporter ved kjøretid.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-111">The ER format component of the solution must contain the **Excel\\File** format element, and that format element must be linked to the Word document that will be used as the template for generated reports at runtime.</span></span> <span data-ttu-id="d3ea9-112">Hvis du vil konfigurere ER-formatkomponenten, må du åpne [utkast](general-electronic-reporting.md#component-versioning)versjonen for den opprettede ER-konfigurasjonen i ER-formatutformingen.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-112">To configure the ER format component, you must open the [draft](general-electronic-reporting.md#component-versioning) version of the created ER configuration in the ER format designer.</span></span> <span data-ttu-id="d3ea9-113">Legg deretter til elementet **Excel\\Fil**, knytt Word-malen til det redigerbare ER-formatet, og koble denne malen til elementet **Excel\\Fil** du la til.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-113">Then add the **Excel\\File** element, attach your Word template to the editable ER format, and link that template to the **Excel\\File** element that you added.</span></span>

> [!NOTE]
> <span data-ttu-id="d3ea9-114">Når du knytter til en mal manuelt, må du bruke en [dokumenttype](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management#configure-document-types) som tidligere har blitt [konfigurert](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents) for dette formålet, i ER-parameterne for å lagre maler i ER-formater.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-114">When you attach a template, you must use a [document type](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management#configure-document-types) that has previously been [configured](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents) in the ER parameters to store templates of ER formats.</span></span>

![Tilknytte en mal på Formatutforming-siden](./media/er-design-configuration-word-image3.gif)

<span data-ttu-id="d3ea9-116">Du kan legge til de nestede elementene **Excel\\Område** og **Excel\\Celle** for elementet **Excel\\Fil** for å angi strukturen til dataene som skal registreres i genererte rapporter ved kjøretid.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-116">You can add **Excel\\Range** and **Excel\\Cell** nested elements for the **Excel\\File** element to specify the structure of data that will be entered in generated reports at runtime.</span></span> <span data-ttu-id="d3ea9-117">Du må deretter binde disse elementene til datakilder i det redigerbare ER-formatet for å angi de faktiske dataene som skal registreres i genererte rapporter ved kjøretid.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-117">You must then bind those elements to data sources of the editable ER format to specify the actual data that will be entered in generated reports at runtime.</span></span>

![Legge til nestede elementer på Formatutforming-siden](./media/er-design-configuration-word-image4.gif)

<span data-ttu-id="d3ea9-119">Når du lagrer endringene i ER-formatet på utformingstidspunktet, lagres den hierarkiske formatstrukturen i den tilknyttede Word-malen som en [egendefinert XML-del](https://docs.microsoft.com/visualstudio/vsto/custom-xml-parts-overview?view=vs-2019) med navnet **Rapport**.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-119">When you save your changes to the ER format at design time, the hierarchical format structure is stored in the attached Word template as a [custom XML part](https://docs.microsoft.com/visualstudio/vsto/custom-xml-parts-overview?view=vs-2019) that is named **Report**.</span></span> <span data-ttu-id="d3ea9-120">Du må ha tilgang til den endrede malen, laste den ned fra Finance, lagre den lokalt og åpne den i skrivebordsversjonen av Word.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-120">You must access the modified template, download it from Finance, store it locally, and open it in the Word desktop application.</span></span> <span data-ttu-id="d3ea9-121">Illustrasjonen nedenfor viser den lokalt lagrede eksempelmalen for kontrollrapporten som inneholder den egendefinerte XML-delen **Rapport**.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-121">The following illustration shows the locally stored sample template for the control report that contains the **Report** custom XML part.</span></span>

![Forhåndsvise eksempelrapportmalen i skrivebordsversjonen av Word](./media/er-design-configuration-word-image5.gif)

<span data-ttu-id="d3ea9-123">Når bindinger for formatelementene **Excel\\Område** og **Excel\\Celle** kjøres ved kjøretid, kommer dataene som hver binding leverer, inn i det genererte Word-dokumentet som et enkeltfelt i den egendefinerte XML-delen **Rapport**.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-123">When bindings of **Excel\\Range** and **Excel\\Cell** format elements are run at runtime, the data that every binding delivers comes into the generated Word document as an individual field of the **Report** custom XML part.</span></span> <span data-ttu-id="d3ea9-124">Hvis du vil angi verdiene fra feltene i den egendefinerte XML-delen i et generert dokument, må du legge til de riktige Word-[innholdskontrollene](https://docs.microsoft.com/office/client-developer/word/content-controls-in-word) i Word-malen, slik at de kan fungere som plassholdere for data som fylles ut ved kjøretid.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-124">To enter the values from the fields of the custom XML part in a generated document, you must add the appropriate Word [content controls](https://docs.microsoft.com/office/client-developer/word/content-controls-in-word) to your Word template to serve as placeholders for data that will be filled in at runtime.</span></span> <span data-ttu-id="d3ea9-125">Hvis du vil angi hvordan innholdskontroller skal fylles ut, tilordner du hver innholdskontroll til det aktuelle feltet i den egendefinerte XML-delen **Rapport**.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-125">To specify how content controls are filled in, map every content control to the appropriate field of the **Report** custom XML part.</span></span>

![Legge til og tilordne innholdskontroller i skrivebordsversjonen av Word](./media/er-design-configuration-word-image6.gif)

<span data-ttu-id="d3ea9-127">Du må deretter erstatte den opprinnelige Word-malen i det redigerbare ER-formatet med den endrede malen som nå inneholder Word-innholdskontroller som ble tilordnet til feltene i den egendefinerte XML-delen **Rapport**.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-127">You must then replace the original Word template of the editable ER format with the modified template that now contains Word content controls that were mapped to the fields of the **Report** custom XML part.</span></span>

![Erstatte malen på Formatutforming-siden](./media/er-design-configuration-word-image7.gif)

<span data-ttu-id="d3ea9-129">Når du kjører det konfigurerte ER-formatet, brukes den tilknyttede Word-malen til å generere en ny rapport.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-129">When you run the configured ER format, the attached Word template is used to generate a new report.</span></span> <span data-ttu-id="d3ea9-130">De faktiske dataene lagres i Word-rapporten som en egendefinert XML-del med navnet **Rapport**.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-130">The actual data is stored in the Word report as a custom XML part that is named **Report**.</span></span> <span data-ttu-id="d3ea9-131">Når den genererte rapporten åpnes, fylles Word-innholdskontrollene ut med data fra den egendefinerte XML-delen **Rapport**.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-131">When the generated report is opened, the Word content controls are filled in with data from the **Report** custom XML part.</span></span>

## <a name="frequently-asked-questions"></a><span data-ttu-id="d3ea9-132">Vanlige spørsmål</span><span class="sxs-lookup"><span data-stu-id="d3ea9-132">Frequently asked questions</span></span>

<span data-ttu-id="d3ea9-133">**Spørsmål:** Jeg har konfigurert et ER-format slik at det skriver ut et Word-dokument som inneholder en firmaadresse.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-133">**Question:** I configured an ER format to print a Word document that contains a company address.</span></span> <span data-ttu-id="d3ea9-134">I Word-malen for dette ER-formatet satte jeg inn en innholdskontroll for rik tekst for å presentere en firmaadresse.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-134">In the Word template for this ER format, I inserted a rich text content control to present a company address.</span></span> <span data-ttu-id="d3ea9-135">I Finance angav jeg firmaadressen som tekst på flere linjer og valgte **Enter** for å legge til en vognretur for hver linje jeg angav.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-135">In Finance, I entered the company address as multiline text and selected **Enter** to add a carriage return for every line that I entered.</span></span> <span data-ttu-id="d3ea9-136">Derfor forventer jeg at firmaadressen skal vises som tekst på flere linjer i genererte dokumenter.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-136">Therefore, I expect the company address to appear as multiline text in generated documents.</span></span> <span data-ttu-id="d3ea9-137">Adressen vises imidlertid som én tekstlinje som inneholder spesialsymboler i stedet for vognreturer.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-137">However, the address appears as a single line of text that contains special symbols instead of carriage returns.</span></span> <span data-ttu-id="d3ea9-138">Hva er feil med innstillingene?</span><span class="sxs-lookup"><span data-stu-id="d3ea9-138">What is wrong with my settings?</span></span>

<span data-ttu-id="d3ea9-139">**Svar:** I stedet for å bruke en innholdskontroll for rik tekst, må du bruke en innholdskontroll for ren tekst og merke av for **Tillat vognreturer (flere avsnitt)** i egenskapene for kontrollen.</span><span class="sxs-lookup"><span data-stu-id="d3ea9-139">**Answer:** Instead of using a rich text content control, you must use a plain text content control and select the **Allow carriage returns (multiple paragraphs)** check box in the control's properties.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="d3ea9-140">Tilleggsressurser</span><span class="sxs-lookup"><span data-stu-id="d3ea9-140">Additional resources</span></span>

- [<span data-ttu-id="d3ea9-141">Bruke ER-konfigurasjoner på nytt med Excel-maler for å generere rapporter i Word-format</span><span class="sxs-lookup"><span data-stu-id="d3ea9-141">Reuse ER configurations with Excel templates to generate reports in Word format</span></span>](./tasks/er-design-configuration-word-2016-11.md)
- [<span data-ttu-id="d3ea9-142">Bygge inn bilder og figurer i dokumenter du genererer ved hjelp av ER</span><span class="sxs-lookup"><span data-stu-id="d3ea9-142">Embed images and shapes in documents that you generate by using ER</span></span>](electronic-reporting-embed-images-shapes.md#embed-an-image-in-a-word-document)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]