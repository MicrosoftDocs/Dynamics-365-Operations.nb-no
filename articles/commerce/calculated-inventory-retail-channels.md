---
title: Beregne beholdningstilgjengelighet for detaljhandelskanaler
description: Dette emnet beskriver alternativene som er tilgjengelige for å vise lagerbeholdningen for butikken og Internett-kanalene.
author: hhainesms
manager: annbe
ms.date: 05/15/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-commerce
ms.technology: ''
audience: Application User
ms.reviewer: v-chgri
ms.search.scope: Retail, Core, Operations
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: hhainesms
ms.search.validFrom: 2020-02-11
ms.dyn365.ops.version: Release 10.0.10
ms.openlocfilehash: 51e6633caa49daeedca685f3323eaf4e14e788a5
ms.sourcegitcommit: e789b881440f5e789f214eeb0ab088995b182c5d
ms.translationtype: HT
ms.contentlocale: nb-NO
ms.lasthandoff: 05/15/2020
ms.locfileid: "3379242"
---
# <a name="calculate-inventory-availability-for-retail-channels"></a><span data-ttu-id="d2c57-103">Beregne beholdningstilgjengelighet for detaljhandelskanaler</span><span class="sxs-lookup"><span data-stu-id="d2c57-103">Calculate inventory availability for retail channels</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="d2c57-104">Dette emnet beskriver hvordan et firma kan bruke Microsoft Dynamics 365 Commerce til å vise estimert beholdningstilgjengelighet for produkter i nett- og butikkanaler.</span><span class="sxs-lookup"><span data-stu-id="d2c57-104">This topic describes how a company can use Microsoft Dynamics 365 Commerce to view estimated on-hand availability for products in the online and store channels.</span></span>

## <a name="accuracy-of-calculation"></a><span data-ttu-id="d2c57-105">Beregningens nøyaktighet</span><span class="sxs-lookup"><span data-stu-id="d2c57-105">Accuracy of calculation</span></span>

<span data-ttu-id="d2c57-106">Commerce bruker flere servere og databaser for å sikre skalerbarhet og ytelse.</span><span class="sxs-lookup"><span data-stu-id="d2c57-106">Commerce uses multiple servers and databases to ensure scalability and performance.</span></span> <span data-ttu-id="d2c57-107">Det er derfor viktig at du forstår at de tilgjengelige beholdningsverdiene som gis via POS-programmet (salgssted), e-Commerce API-ene for beholdningstilgjengelighet (APIer) og lagerbeholdningssidene i Commerce Headquarters ikke kan være 100 prosent nøyaktig i sanntid.</span><span class="sxs-lookup"><span data-stu-id="d2c57-107">Therefore, it's important that you understand that the available inventory values that are provided through the point of sale (POS) application, the e-Commerce inventory availability application programming interfaces (APIs), and the on-hand inventory pages in Commerce Headquarters might not be 100-percent accurate in real time.</span></span> <span data-ttu-id="d2c57-108">Hvis transaksjoner som er opprettet for produkter i nett- eller butikkanalen ennå ikke er synkronisert med Commerce Headquarters-serveren og -databasen, kan det hende at lagerbeholdnings sidene i Commerce Headquarters ikke viser en nøyaktig lagerverdi i sanntid for disse produktene.</span><span class="sxs-lookup"><span data-stu-id="d2c57-108">If transactions that are created for products in the online or store channel haven't yet been synced to the Commerce Headquarters server and database, the on-hand inventory pages in Commerce Headquarters might not show an accurate real-time inventory value for those products.</span></span> <span data-ttu-id="d2c57-109">Hvis du har konfigurert firmaet slik at brukere i Commerce Headquarters eller andre integrerte programmer kan selge, motta, returnere eller på annen måte justere lageret ut av en butikk eller et elektronisk lager, kan det hende at salgsstedet eller den elektroniske kanalen ikke har all informasjon som kreves for å vise en nøyaktig beholdningsverdi for varer i sanntid.</span><span class="sxs-lookup"><span data-stu-id="d2c57-109">Conversely, if you configured your company so that users in Commerce Headquarters or other integrated applications can sell, receive, return, or otherwise adjust inventory out of a store or online warehouse, the POS or online channel might not have all the information that is required to show an accurate real-time on-hand value for items.</span></span>

<span data-ttu-id="d2c57-110">Dette emnet beskriver datasynkroniseringsprosessene som kan kjøres ofte for å begrense ventetiden for data mellom programmer og kanaler.</span><span class="sxs-lookup"><span data-stu-id="d2c57-110">This topic explains the data synchronization processes that can be run frequently to help limit the latency of data between applications or channels.</span></span> <span data-ttu-id="d2c57-111">Det er imidlertid viktig at du forstår at alle tilgjengelige lagerbeholdningsdata som oppgis i løpet av driftsdagen, regnes som en anslått verdi.</span><span class="sxs-lookup"><span data-stu-id="d2c57-111">However, it's critical that you understand that all on-hand availability data that is provided during the operational day is considered an estimated value.</span></span> <span data-ttu-id="d2c57-112">Hvis du prøver å sammenligne lagerbeholdningsinformasjonen som programmet har, med faktisk fysisk lager på hyllene, eller hvis du prøver å sammenligne lagerbeholdnings verdiene som vises i salgsstedet med lagerbeholdningsdataene du finner for det samme lageret i Commerce Headquarters, kan verdiene være forskjellige.</span><span class="sxs-lookup"><span data-stu-id="d2c57-112">Therefore, if you try to compare the on-hand inventory information that the application provides with actual physical inventory on the shelves, or if you try to compare the on-hand values that are shown in POS with the on-hand data that you find for the same warehouse in Commerce Headquarters, the values might differ.</span></span> <span data-ttu-id="d2c57-113">Denne forskjellen i løpet av driftsdagen er forventet og må ikke regnes som et problem.</span><span class="sxs-lookup"><span data-stu-id="d2c57-113">This difference during the operational day is expected and should not be considered an issue.</span></span> <span data-ttu-id="d2c57-114">Hvis du vil revidere data og kontrollere at verdiene som oppgis i API-ene for lagertilgjengelighet og i handelshovedkvarteret samsvarer med de faktiske fysiske enhetene du finner på butikken eller i lagerhyllene, er det best å gjøre det etter at kanaloperasjonene er stoppet for dagen, og alle transaksjoner er riktig synkronisert mellom handelshovedkvarteret og kanalen.</span><span class="sxs-lookup"><span data-stu-id="d2c57-114">If you want to audit data and make sure that the values that are provided in the inventory availability APIs and Commerce Headquarters match the actual physical units that you find on your store or warehouse shelves, the best time to do it is after channel operations have stopped for the day and all transactions have been correctly synced between Commerce Headquarters and the channel.</span></span>

## <a name="use-inventory-lookup-apis-for-e-commerce-inventory-availability-requests"></a><span data-ttu-id="d2c57-115">Bruk AP-Ier for lageroppslag for e-handelsforespørsler om lagertilgjengelighet</span><span class="sxs-lookup"><span data-stu-id="d2c57-115">Use inventory lookup APIs for e-Commerce inventory availability requests</span></span>

<span data-ttu-id="d2c57-116">Du kan bruke følgende API-er til å vise lagertilgjengelighet for et produkt når kundene handler i et område for e-handel.</span><span class="sxs-lookup"><span data-stu-id="d2c57-116">You can use the following APIs to show inventory availability for a product when your customers are shopping on an e-Commerce site.</span></span>

- <span data-ttu-id="d2c57-117">**GetEstimatedAvailability** – Bruk denne API-en til å få lagertilgjengelighet for varen i lageret for e-handelskanalen eller alle lagre som er koblet til konfigurasjonen av oppfyllelsesgruppen for e-handelskanalen.</span><span class="sxs-lookup"><span data-stu-id="d2c57-117">**GetEstimatedAvailabilty** – Use this API to get inventory availability for the item in the e-Commerce channel warehouse or all warehouses that are linked to the configuration of the fulfillment group for the e-Commerce channel.</span></span> <span data-ttu-id="d2c57-118">Denne API-en kan også brukes på lagre i et bestemt søkeområde eller en radius, basert på data lengdegrad og breddegrad.</span><span class="sxs-lookup"><span data-stu-id="d2c57-118">This API can also be used for warehouses in a specific search area or radius, based on longitude and latitude data.</span></span>
- <span data-ttu-id="d2c57-119">**GetEstimatedProductWarehouseAvailability** – Bruk denne API-en til å be om beholdning for en vare fra et bestemt lager.</span><span class="sxs-lookup"><span data-stu-id="d2c57-119">**GetEstimatedProductWarehouseAvailability** – Use this API to request inventory for an item from a specific warehouse.</span></span> <span data-ttu-id="d2c57-120">Du kan for eksempel bruke den til å vise lagertilgjengelighet i scenarioer som involverer ordreplukking.</span><span class="sxs-lookup"><span data-stu-id="d2c57-120">For example, you can use it to show inventory availability in scenarios that involve order pickup.</span></span>

> [!NOTE]
> <span data-ttu-id="d2c57-121">Disse API-ene erstatter API-ene **GetProductAvailabilities** og **GetAvailableInventoryNearby** i Dynamics 365 Retail versjon 10.0.7 og tidligere.</span><span class="sxs-lookup"><span data-stu-id="d2c57-121">These APIs replace the **GetProductAvailabilities** and **GetAvailableInventoryNearby** APIs in Dynamics 365 Retail version 10.0.7 and earlier.</span></span>

<span data-ttu-id="d2c57-122">Begge API-ene henter data fra Commerce-serveren og gir et overslag over lagerbeholdningen for en bestemt kombinasjon av et produkt eller en produktvariant og et lager.</span><span class="sxs-lookup"><span data-stu-id="d2c57-122">Both APIs fetch data from the Commerce server and provide an estimate of on-hand inventory for a specific combination of a product or product variant and a warehouse.</span></span> <span data-ttu-id="d2c57-123">Selv om andre API-er som er tilgjengelige på Commerce-serveren, kan gå direkte til handelshovedkvarteret for å hente lagerbeholdningsantall for produkter, anbefaler vi ikke at de brukes i et miljø med e-handel, på grunn av potensielle ytelsesproblemer og den relaterte innvirkningen som disse hyppige forespørslene kan ha på Commerce Headquarters-serverne.</span><span class="sxs-lookup"><span data-stu-id="d2c57-123">Although other APIs that are available on the Commerce server can go directly to Commerce Headquarters to fetch on-hand quantities for products, we don't recommend that they be used in an e-Commerce environment because of potential performance issues and the related impact that these frequent requests can have on your Commerce Headquarters servers.</span></span> <span data-ttu-id="d2c57-124">Hvis lagerbeholdningen blir beregnet gjennom Commerce-serveren, er det mer sannsynlig at beregningen tar med varer som ble solgt i nylige e-handelstransaksjoner som ennå ikke er synkronisert til Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="d2c57-124">Additionally, if the on-hand inventory is calculated through the Commerce server, the calculation is more likely to include inventory that was sold in recent e-Commerce transactions that haven't yet been synced to Commerce Headquarters.</span></span> <span data-ttu-id="d2c57-125">Selv om det er mulig at Commerce Headquarters ikke har informasjon om disse transaksjonene, har Commerce-serveren og kanaldatabasen dataene.</span><span class="sxs-lookup"><span data-stu-id="d2c57-125">Although Commerce Headquarters might not have information about these transactions, the Commerce server and channel database have the data.</span></span> <span data-ttu-id="d2c57-126">Derfor blir det tatt hensyn til dataene, og dette kan bidra til å gi et mer nøyaktig estimat over den tilgjengelige beholdningen for et produkt.</span><span class="sxs-lookup"><span data-stu-id="d2c57-126">Therefore, the data will be factored in and can help provide a more accurate estimate of a product's available inventory.</span></span>

### <a name="get-started-with-e-commerce-calculated-inventory-availability"></a><span data-ttu-id="d2c57-127">Kom i gang med beregnet lager tilgjengelighet for e-handel</span><span class="sxs-lookup"><span data-stu-id="d2c57-127">Get started with e-Commerce calculated inventory availability</span></span>

<span data-ttu-id="d2c57-128">Før du bruker de to APIene som ble nevnt tidligere, må du aktivere funksjonen **Beregning av optimalisert produkttilgjengelighet** via arbeidsområdet **Funksjonsbehandling** i Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="d2c57-128">Before you use the two APIs that were mentioned earlier, you must enable the **Optimized product availabity calculation** feature through the **Feature management** workspace in Commerce Headquarters.</span></span>

<span data-ttu-id="d2c57-129">Før API-ene kan beregne det beste estimatet for beholdningstilgjengelighet for en vare, må et periodisk statisk utvalg av beholdsningstilgjengelighet fra Commerce Headquarters behandles og sendes til kanaldatabasen som Commerce Scale Unit for e-handel bruker.</span><span class="sxs-lookup"><span data-stu-id="d2c57-129">Before the APIs can calculate the best estimate of inventory availability for an item, a periodic snapshot of inventory availability from Commerce Headquarters must be processed and sent to the channel database that the e-Commerce Commerce Scale Unit uses.</span></span> <span data-ttu-id="d2c57-130">Det statiske utvalget representerer informasjonen som Commerce Headquarters har om beholdningstilgjengelighet for en bestemt kombinasjon av et produkt eller en produktvariant og et lager.</span><span class="sxs-lookup"><span data-stu-id="d2c57-130">The snapshot represents the information that Commerce Headquarters has about inventory availability for a specific combination of a product or product variant and a warehouse.</span></span> <span data-ttu-id="d2c57-131">Dette kan inkludere lagerjusteringer eller bevegelser som forårsakes av lagertilganger, eller av forsendelser eller andre prosesser som utføres i Commerce Headquarters, og som e-handelskanalen har informasjon om, bare på grunn av synkroniseringsprosessen.</span><span class="sxs-lookup"><span data-stu-id="d2c57-131">It can include inventory adjustments or movements that are caused by inventory receipts, or by shipments or other processes that are performed in Commerce Headquarters and that the e-Commerce channel has information about only because of the synchronization process.</span></span>

<span data-ttu-id="d2c57-132">Det statiske utvalget av databasen som jobben **Produkttilgjengelighet** oppretter, beregner bare beholdningstransaksjonene som ble behandlet og postert i Commerce Headquarters da det statiske utvalget ble tatt.</span><span class="sxs-lookup"><span data-stu-id="d2c57-132">The database snapshot that the **Product availability** job creates calculates only the inventory transactions that were processed and posted in Commerce Headquarters at the time when the snapshot was taken.</span></span> <span data-ttu-id="d2c57-133">Hvis beholdningen ble solgt for et produkt i et butikklager gjennom et kontantsalg eller et asynkront kundeordresalg i POS-programmet, har ikke Commerce Headquarters direkte informasjon om den tilknyttede lageravgangstransaksjonen for salget.</span><span class="sxs-lookup"><span data-stu-id="d2c57-133">If inventory was sold for a product in a store warehouse through a cash-and-carry or asynchronous customer order sale in the POS application, Commerce Headquarters won't immediately have information about the related inventory issue transaction for the sale.</span></span> <span data-ttu-id="d2c57-134">Det vil ha informasjon om beholdningen som er solgt for disse typene butikksalg, bare etter at P-jobben laster opp den tilknyttede transaksjonen fra butikkens kanaldatabase til Commerce Headquarters, og den tilknyttede salgsordren opprettes via utdragspostering eller posteringsprosessene for fordelingsfeed.</span><span class="sxs-lookup"><span data-stu-id="d2c57-134">It will have information about the inventory that is sold for these types of store sales only after the P-job uploads the related transaction from the store's channel database into Commerce Headquarters and the related sales order is created through statement posting or the trickle feed posting processes.</span></span> <span data-ttu-id="d2c57-135">Prosessen med å opprette ordren i Commerce Headquarters oppretter de tilknyttede beholdningstransaksjonene.</span><span class="sxs-lookup"><span data-stu-id="d2c57-135">The process of creating the order in Commerce Headquarters creates the related inventory transactions.</span></span> <span data-ttu-id="d2c57-136">For ordrer for e-handelskanalen har Commerce Headquarters bare informasjon om beholdningstransaksjonene, etter at transaksjonene er sendt til Commerce Headquarters via P-jobben, og ordresynkroniseringsprosessen er fullført.</span><span class="sxs-lookup"><span data-stu-id="d2c57-136">For e-Commerce channel orders, Commerce Headquarters has information about the inventory transactions only after the transactions are sent to Commerce Headquarters through the P-job and the order synchronization process is completed.</span></span> <span data-ttu-id="d2c57-137">Det er derfor viktig at du forstår at verdien for lagerets statiske utvalg som er oppgitt i jobben **Produkttilgjengelighet**, ikke er 100 prosent nøyaktig i sanntid på grunn av den konstante salgsbehandlingen som skjer på tvers av distribuerte servere.</span><span class="sxs-lookup"><span data-stu-id="d2c57-137">Therefore, it's important that you understand that the inventory snapshot value that is provided in the **Product availability** job might not be 100-percent accurate in real time because of the constant sales processing that occurs across distributed servers.</span></span>

<span data-ttu-id="d2c57-138">Følg denne fremgangsmåten for å ta et øyeblikksbilde av lager i Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="d2c57-138">To take a snapshot of inventory in Commerce Headquarters, follow these steps.</span></span>

1. <span data-ttu-id="d2c57-139">Gå til **Retail og Commerce \> IT for Retail og Commerce \> Produkter og beholdning \> Produkttilgjengelighet**.</span><span class="sxs-lookup"><span data-stu-id="d2c57-139">Go to **Retail and Commerce \> Retail and Commerce IT \> Products and inventory \> Product availability**.</span></span>
1. <span data-ttu-id="d2c57-140">Velg **OK** for å kjøre jobben **Produkttilgjengelighet**.</span><span class="sxs-lookup"><span data-stu-id="d2c57-140">Select **OK** to run the **Product availability** job.</span></span> <span data-ttu-id="d2c57-141">Du kan også planlegge denne jobben slik at den kjøres i et parti.</span><span class="sxs-lookup"><span data-stu-id="d2c57-141">You can also schedule this job so that it's run in a batch.</span></span>

<span data-ttu-id="d2c57-142">Når jobben **Produkttilgjengelighet** er ferdig kjørt, må dataene som ble tatt opp, sendes til databasene for e-handelskanalen, slik at det siste statiske utvalget av Commerce Headquarters-beholdningen kan vurderes i beregningen av den estimerte lagerbeholdningen.</span><span class="sxs-lookup"><span data-stu-id="d2c57-142">After the **Product availability** job has finished running, the data that was captured must be pushed to the e-Commerce channel databases, so that the latest Commerce Headquarters inventory snapshot can be considered in the calculation of estimated on-hand inventory.</span></span>

1. <span data-ttu-id="d2c57-143">Gå til **Detaljhandel og handel \> IT for detaljhandel og handel \> Distribusjonsplan**.</span><span class="sxs-lookup"><span data-stu-id="d2c57-143">Go to **Retail and Commerce \> Retail and Commerce IT \> Distribution schedule**.</span></span>
1. <span data-ttu-id="d2c57-144">Kjør jobben **1130** (**Produkttilgjengelighet**) for å synkronisere dataene fra det statiske utvalget som jobben **Produkttilgjengelighet** opprettet fra Commerce Headquarters til kanaldatabasene dine.</span><span class="sxs-lookup"><span data-stu-id="d2c57-144">Run the **1130** (**Product availability**) job to sync the snapshot data that the **Product availability** job created from Commerce Headquarters to your channel databases.</span></span>

<span data-ttu-id="d2c57-145">Når beholdningstilgjengelighet forespørres fra fra API-en **GetEstimatedAvailabilty** eller **ProductWarehouseInventoryAvailabilities**, kjøres en beregning for å få best mulig beregning av beholdningen for produktet.</span><span class="sxs-lookup"><span data-stu-id="d2c57-145">When inventory availability is requested from the **GetEstimatedAvailabilty** or **ProductWarehouseInventoryAvailabilities** API, a calculation is run to try to get the best possible estimate of inventory for the product.</span></span> <span data-ttu-id="d2c57-146">Beregningen refererer til en hvilken som helst e-handelskundeordre i kanaldatabasen, men som ikke ble tatt med i dataene for det statiske utvalget som 1130-jobben leverte.</span><span class="sxs-lookup"><span data-stu-id="d2c57-146">The calculation references any e-Commerce customer orders that are in the channel database but that weren't included in the snapshot data that the 1130 job provided.</span></span> <span data-ttu-id="d2c57-147">Denne logikken utføres ved å spore den siste behandlede lagertransaksjonen fra Commerce Headquarters og sammenligne den med transaksjonene i kanaldatabasen.</span><span class="sxs-lookup"><span data-stu-id="d2c57-147">This logic is performed by tracking the last processed inventory transaction from Commerce Headquarters and comparing it with the transactions in the channel database.</span></span> <span data-ttu-id="d2c57-148">Det gir et utgangspunkt for logikken for beregning på kanalsiden, slik at de ekstra lagerflyttingene som oppstod for salgstransaksjoner for kundeordre i kanal for e-handel, kan settes sammen til den estimerte lagerverdien som API-en viser.</span><span class="sxs-lookup"><span data-stu-id="d2c57-148">It provides a baseline for the channel-side calculation logic, so that the additional inventory movements that occurred for customer order sales transactions in the e-Commerce channel database can be factored into the estimated inventory value that the API provides.</span></span>

<span data-ttu-id="d2c57-149">Logikken for beregning av kanalsiden returnerer en estimert fysisk tilgjengelig verdi og en total tilgjengelig verdi for det forespurte produktet og lageret.</span><span class="sxs-lookup"><span data-stu-id="d2c57-149">The channel-side calculation logic returns an estimated physically available value and a total available value for the requested product and warehouse.</span></span> <span data-ttu-id="d2c57-150">Verdiene kan vises på ditt e-handelsområde hvis du vil, eller de kan brukes til å utløse andre forretningslogikker på ditt e-handelsområde.</span><span class="sxs-lookup"><span data-stu-id="d2c57-150">The values can be shown on your e-Commerce site if you want, or they can be used to trigger other business logic on your e-Commerce site.</span></span> <span data-ttu-id="d2c57-151">Du kan for eksempel vise en "ikke på lager"-melding i stedet for det faktiske lagerantallet som API-en sendte.</span><span class="sxs-lookup"><span data-stu-id="d2c57-151">For example, you can show an "out of stock" message instead of the actual on-hand quantity that the API passed.</span></span>

<span data-ttu-id="d2c57-152">Beregningslogikken som API-ene for e-handel på kanalsiden bruker for den estimerte lagerverdien, kan evaluere lageret basert bare på kundeordrer som er opprettet i kanaldatabasen, men som ennå ikke er synkronisert og postert i Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="d2c57-152">The calculation logic that the channel-side e-Commerce APIs use for the estimated inventory value can evaluate inventory based only on customer orders that have been created in the channel database but that haven't yet been synced and posted in Commerce Headquarters.</span></span> <span data-ttu-id="d2c57-153">Hvis kanaldatabasen også inneholder transaksjonsdata for kontantsalg for butikkspesifikke lagre, vil kontantsalget ikke faktoreres til beregning av ehandel på kanalsiden for disse lagrene.</span><span class="sxs-lookup"><span data-stu-id="d2c57-153">If your channel database also contains transactional data for cash-and-carry sales for store-specific warehouses, the cash-and-carry sales aren't factored into the channel-side e-Commerce calculation for those warehouses.</span></span>

## <a name="configure-the-inventory-lookup-operation-in-the-pos-channel"></a><span data-ttu-id="d2c57-154">Konfigurer lageroppslagsoperasjonen i POS-kanalen</span><span class="sxs-lookup"><span data-stu-id="d2c57-154">Configure the inventory lookup operation in the POS channel</span></span>

<span data-ttu-id="d2c57-155">I Retail versjon 10.0.9 og tidligere brukte operasjonen **Beholdningsoppslag** fra POS et servicekall i sanntid til Commerce Headquarters for å få beholdningsinformasjon for det valgte produktet, både for brukerens gjeldende butikk og andre butikker som er konfigurert for oppfyllelsesgruppen som en del av kanalkonfigurasjonen for butikken.</span><span class="sxs-lookup"><span data-stu-id="d2c57-155">In Retail version 10.0.9 and earlier, the **Inventory lookup** operation from POS used a real-time service call to Commerce Headquarters to get inventory information for the selected product, for both the user's current store and any other stores that are configured for the fulfillment group as part of the channel configuration for the store.</span></span> <span data-ttu-id="d2c57-156">I Commerce versjon 10.0.10 og senere kan du slå av servicekall i sanntid til Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="d2c57-156">In Commerce version 10.0.10 and later, you can turn off real-time service calls to Commerce Headquarters.</span></span> <span data-ttu-id="d2c57-157">I stedet kan du bruke beregning på kanalsiden på Commerce-serveren til å fastslå lagerbeholdningen som er fysisk tilgjengelig for butikken og andre lokasjoner som er definert i oppfyllelsesgruppen.</span><span class="sxs-lookup"><span data-stu-id="d2c57-157">Instead, you can use channel-side calculation on the Commerce server to determine the on-hand inventory that is physically available for the store and any other locations that are defined in the fulfillment group.</span></span> <span data-ttu-id="d2c57-158">Denne kanalberegnede lagerkonfigurasjonen er også nyttig for steder der Internett-tilkoblingen er upålitelig, fordi du ikke behøver å være tilkoblet for å få lageroppslag fra Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="d2c57-158">This channel-calculated inventory configuration is also useful for locations where internet connectivity is unreliable, because you don't have to be online to get inventory lookups from Commerce Headquarters.</span></span>

<span data-ttu-id="d2c57-159">Når beregning på kanalsiden er riktig konfigurert og administrert, kan det gi et mer pålitelig estimat over gjeldende butikkbeholdning, fordi dette bruker transaksjonsdataene som er i handelskanaldatabasen, men som Commerce Headquarters kanskje ikke har informasjon om ennå.</span><span class="sxs-lookup"><span data-stu-id="d2c57-159">When channel-side calculation is correctly configured and managed, it can provide a more reliable estimate of the current store inventory, because it uses the transactional data that is in the Commerce channel database but that Commerce Headquarters might not yet have information about.</span></span> <span data-ttu-id="d2c57-160">Hvis du for eksempel bruker det eksisterende servicekallet i sanntid for lageroppslag i POS, vil ikke Commerce Headquarters ennå ha informasjon om kontantsalg som akkurat har skjedd for et produkt.</span><span class="sxs-lookup"><span data-stu-id="d2c57-160">For example, if you use the existing real-time service call for inventory lookups in POS, Commerce Headquarters probably won't yet have information about a cash-and-carry sale that just occurred for a product.</span></span> <span data-ttu-id="d2c57-161">Derfor vil lagerbeholdningsverdien som er returnert av Commerce Headquarters for dette produktet, sannsynligvis overskride butikkens faktiske lagerbeholdning med én enhet.</span><span class="sxs-lookup"><span data-stu-id="d2c57-161">Therefore, the on-hand inventory value that Commerce Headquarters returns for that product will probably exceed the store's actual on-hand inventory by one unit.</span></span> <span data-ttu-id="d2c57-162">Hvis du imidlertid bruker beregning på kanalsiden, kan kontantsalget faktoreres inn i beregningen og trekkes fra beholdningsverdien som vises.</span><span class="sxs-lookup"><span data-stu-id="d2c57-162">However, if you use channel-side calculation, the cash-and-carry sale can be factored into the calculation and deducted from the on-hand value that is shown.</span></span> <span data-ttu-id="d2c57-163">Selv om verdiene som både kanalsiden og servicekallet i sanntid oppgir, bare er estimater av lagerbeholdningen, er verdien som beregning på kanalsiden oppgir, mye mer sannsynlig å være nøyaktig for den gjeldende butikken.</span><span class="sxs-lookup"><span data-stu-id="d2c57-163">Although the values that both the channel-side calculation and the real-time service call provide are only estimates of on-hand inventory, the value that the channel-side calculation provides is much more likely to be accurate for the current store.</span></span>

### <a name="get-started-with-pos-channel-side-calculated-inventory-availability"></a><span data-ttu-id="d2c57-164">Kom i gang med beregnet lagertilgjengelighet for POS-kanalsiden</span><span class="sxs-lookup"><span data-stu-id="d2c57-164">Get started with POS channel-side calculated inventory availability</span></span>

<span data-ttu-id="d2c57-165">Hvis du vil bruke logikken for beregning av tilgjengelighet og slå av sanntidstjenestekall for lageroppslag fra salgsstedsappen, må du først aktivere funksjonen **Beregning av optimalisert produkttilgjengelighet** via arbeidsområdet **Funksjonsbehandling** i Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="d2c57-165">To use the channel-side calculation logic and turn off real-time service calls for inventory lookups from the POS application, you must first enable the **Optimized product availabity calculation** feature through the **Feature management** workspace in Commerce Headquarters.</span></span> <span data-ttu-id="d2c57-166">I tillegg til å aktivere funksjonen, må du endre **funksjonalitetsprofilen**.</span><span class="sxs-lookup"><span data-stu-id="d2c57-166">In addition to enabling the feature, you must make changes to the **Functionality profile**.</span></span>

<span data-ttu-id="d2c57-167">Hvis du vil endre **funksjonalitetsprofilen**, gjør du følgende:</span><span class="sxs-lookup"><span data-stu-id="d2c57-167">To change the **Functionality profile**, follow these steps:</span></span>

1. <span data-ttu-id="d2c57-168">Gå til **Retail og Commerce \> Kanaloppsett \> Salgsstedsoppsett \> Salgsstedsprofiler \> Funksjonalitetsprofiler**.</span><span class="sxs-lookup"><span data-stu-id="d2c57-168">Go to **Retail and Commerce \> Channel setup \> POS setup \> POS profiles \> Functionality profiles**.</span></span>
1. <span data-ttu-id="d2c57-169">Velg en funksjonalitetsprofil.</span><span class="sxs-lookup"><span data-stu-id="d2c57-169">Select a functionality profile.</span></span>
1. <span data-ttu-id="d2c57-170">I hurtigfanen **Funksjoner**, i delen **Beregning av lagertilgjengelighet** endrer du verdien i feltet **Modus for beregning av lagertilgjengelighet** fra **Sanntidstjeneste** til **Kanal**.</span><span class="sxs-lookup"><span data-stu-id="d2c57-170">On the **Functions** FastTab, in the **Invent availability calculation** section, change the value of the **Invent availability calculation mode** field from **Real time service** to **Channel**.</span></span> <span data-ttu-id="d2c57-171">Som standard bruker alle funksjonalitetsprofiler servicekall i sanntid.</span><span class="sxs-lookup"><span data-stu-id="d2c57-171">By default, all functionality profiles use real-time service calls.</span></span> <span data-ttu-id="d2c57-172">Derfor må du endre verdien i dette feltet hvis du vil bruke logikken for beregning på kanalsiden.</span><span class="sxs-lookup"><span data-stu-id="d2c57-172">Therefore, you must change the value of this field if you want to use channel-side calculation logic.</span></span> <span data-ttu-id="d2c57-173">Hver detaljhandelsbutikk som er koblet til den valgte funksjonalitetsprofilen, påvirkes av denne endringen.</span><span class="sxs-lookup"><span data-stu-id="d2c57-173">Every retail store that is linked to the selected functionality profile will be affected by this change.</span></span>

<span data-ttu-id="d2c57-174">Du må deretter synkronisere endringene i kanalen via distribusjonsplanprosessen, ved å gjøre følgende:</span><span class="sxs-lookup"><span data-stu-id="d2c57-174">You must then sync the changes to the channel through the distribution schedule process by performing the following steps:</span></span>

1. <span data-ttu-id="d2c57-175">Gå til **Detaljhandel og handel \> IT for detaljhandel og handel \> Distribusjonsplan**.</span><span class="sxs-lookup"><span data-stu-id="d2c57-175">Go to **Retail and Commerce \> Retail and Commerce IT \> Distribution schedule**.</span></span>
1. <span data-ttu-id="d2c57-176">Kjør jobben **1070** (**Kanalkonfigurasjon**).</span><span class="sxs-lookup"><span data-stu-id="d2c57-176">Run the **1070** (**Channel configuration**) job.</span></span>

<span data-ttu-id="d2c57-177">Når konfigurasjonen er fullført, bruker informasjonen som er oppgitt om fysisk tilgjengelig lager, ikke lenger et servicekall i sanntid når en bruker i POS-programmet bruker operasjonen **Lageroppslag** (standard- og matrisevisning).</span><span class="sxs-lookup"><span data-stu-id="d2c57-177">After the configuration is completed, the information that is provided about physically available inventory no longer uses a real-time service call when a user in the POS application uses the **Inventory lookup** operation (standard and matrix views).</span></span> <span data-ttu-id="d2c57-178">I stedet beregnes data om fysisk tilgjengelig lager for den gjeldende butikken og alle butikkene i oppfyllelsesgruppen på grunnlag av det siste kjente statiske utvalget som ble levert til kanaldatabasen fra Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="d2c57-178">Instead, data about physically available inventory for the current store and all the stores in the fulfillment group is calculated based on the last-known snapshot that was delivered to the channel database from Commerce Headquarters.</span></span> <span data-ttu-id="d2c57-179">Verdien for det statiske utvalget revideres ytterligere av beregningen på kanalsiden for å justere den fysisk tilgjengelige verdien, basert på andre salgs- eller returtransaksjoner som finnes for det valgte produktet i kanaldatabasen, og som ikke var inkludert i det siste synkroniserte øyeblikksbildet fra 1130-jobben.</span><span class="sxs-lookup"><span data-stu-id="d2c57-179">The snapshot value is further refined by the channel-side calculation to adjust the physically available value, based on additional sales or return transactions that exist for the selected product in the channel database that were not included in the last synchronized snapshot from the 1130 job.</span></span> <span data-ttu-id="d2c57-180">Hvis kanaldatabasen ikke inneholder transaksjonsdata for noen av lagrene eller butikkene i oppfyllelsesgruppen, inneholder den ingen ekstra transaksjoner som kan beregnes i en omberegning av verdien.</span><span class="sxs-lookup"><span data-stu-id="d2c57-180">If the channel database doesn't contain transactional data for any of the warehouses or stores in the fulfillment group, it contains no additional transactions that can be factored into a recalculation of the value.</span></span> <span data-ttu-id="d2c57-181">Derfor er det beste estimatet for lagerbeholdningen som kan vises for disse lagrene eller butikkene, dataene fra det siste kjente statiske utvalget for Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="d2c57-181">Therefore, the best estimate of on-hand inventory that can be shown for those warehouses or stores is the data from the last-known Commerce Headquarters snapshot.</span></span>

<span data-ttu-id="d2c57-182">Skjermene **Ordreoppfyllelse** i POS drar også nytte av beregningen på kanalsiden for å vise lagerbeholdning for varer når en ordreoppfyllelseslinje er valgt, og en bruker viser **Detaljer**-panelet for lagerbeholdningen for den valgte varen.</span><span class="sxs-lookup"><span data-stu-id="d2c57-182">The **Order fulfillment** screens of POS also leverage the channel side calculation to show on-hand inventory for items when an order fulfillment line is selected and a user views the **Details** panel for on-hand inventory for the selected item.</span></span>

## <a name="optimize-your-inventory-data"></a><span data-ttu-id="d2c57-183">Optimalisere beholdningsdataene</span><span class="sxs-lookup"><span data-stu-id="d2c57-183">Optimize your inventory data</span></span>

<span data-ttu-id="d2c57-184">Hvis du vil sikre det best mulige estimatet for lageret, er det viktig at du bruker følgende satsvise jobber for handel og kjører dem ofte:</span><span class="sxs-lookup"><span data-stu-id="d2c57-184">To ensure the best possible estimate of inventory, it's critical that you use the following Commerce batch jobs and run them frequently:</span></span>

- <span data-ttu-id="d2c57-185">**P-jobben** – P-jobben finnes på siden **Ddistribusjonsplaner** og bør kjøres ofte.</span><span class="sxs-lookup"><span data-stu-id="d2c57-185">**P-job** – The P-job is found on the **Distribution schedules** page and should be run frequently.</span></span> <span data-ttu-id="d2c57-186">Denne jobben bringer e-handelsordrer, asynkrone kundeordrer som POS oppretter, og kontantbestillinger som er opprettet fra kanaldatabasene, til Commerce Headquarters, slik at de kan behandles videre.</span><span class="sxs-lookup"><span data-stu-id="d2c57-186">This job brings e-Commerce orders, asynchronous customer orders that POS created, and cash-and-carry orders that POS created from the channel databases into Commerce Headquarters, so that they can be processed further.</span></span> <span data-ttu-id="d2c57-187">Før disse dataene er synkronisert fra kanalen til Commerce Headquarters, har ikke Commerce Headquarters informasjon om lagerjusteringer av produkter i lagrene som blir resultatet av disse transaksjonene.</span><span class="sxs-lookup"><span data-stu-id="d2c57-187">Until this data is synced from the channel to Commerce Headquarters, Commerce Headquarters has no information about inventory adjustments to products in the warehouses that result from those transactions.</span></span>
- <span data-ttu-id="d2c57-188">**Synkroniser ordrer** – Denne jobben behandler rå transaksjonsdata i Commerce Headquarters som P-jobben tilbyr, og konverterer e-handel og asynkrone kundeordretransaksjoner til salgsordrer i Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="d2c57-188">**Synchronize orders** – This job processes the raw transactional data in Commerce Headquarters that the P-job provides and converts e-Commerce and asynchronous customer order transactions into sales orders in Commerce Headquarters.</span></span> <span data-ttu-id="d2c57-189">Før denne jobben er behandlet og salgsordrene er opprettet, blir det ikke opprettet noen lagertransaksjoner.</span><span class="sxs-lookup"><span data-stu-id="d2c57-189">Until this job is processed and the sales orders are created, no inventory transactions are created.</span></span> <span data-ttu-id="d2c57-190">Lagerbeholdningen i Commerce Headquarters vil derfor ikke vurdere transaksjonene.</span><span class="sxs-lookup"><span data-stu-id="d2c57-190">Therefore, on-hand inventory in Commerce Headquarters won't consider the transactions.</span></span>
- <span data-ttu-id="d2c57-191">**Beregn transaksjonsutdrag satsvis** – For kontanttransaksjoner som opprettes i butikken, sikrer fordelingsfeedposteringen at lageret som er knyttet til salget, oppdateres effektivt.</span><span class="sxs-lookup"><span data-stu-id="d2c57-191">**Calculate transactional statements in batch** – For cash-and-carry transactions that are created in the store, the trickle feed posting process ensures that inventory that is related to the sales is updated efficiently.</span></span> <span data-ttu-id="d2c57-192">Hvis du vil ha den mest effektive behandlingen av lagertransaksjoner for kontant, må du konfigurere systemet til å bruke [fordelingsfeedpostering](https://docs.microsoft.com/dynamics365/commerce/trickle-feed).</span><span class="sxs-lookup"><span data-stu-id="d2c57-192">To get the most efficient processing of inventory transactions for cash-and-carry orders, make sure that you configure your system to use [trickle feed posting](https://docs.microsoft.com/dynamics365/commerce/trickle-feed).</span></span>
- <span data-ttu-id="d2c57-193">**Poster transaksjonsutdrag satsvis** – Denne jobben er også nødvendig for fordelingsfeedpostering.</span><span class="sxs-lookup"><span data-stu-id="d2c57-193">**Post transactional statements in batch** – This job is also required for trickle feed posting.</span></span> <span data-ttu-id="d2c57-194">Den følger etter jobben **Beregn transaksjonsutdrag satsvis**.</span><span class="sxs-lookup"><span data-stu-id="d2c57-194">It follows the **Calculate transactional statements in batch** job.</span></span> <span data-ttu-id="d2c57-195">Denne jobben posterer de beregnede utdragene systematisk, slik at salgsordrer for kontantsalg opprettes i Commerce Headquarters og Commerce Headquarters mer nøyaktig gjenspeiler butikkens lager.</span><span class="sxs-lookup"><span data-stu-id="d2c57-195">This job systematically posts the calculated statements, so that sales orders for cash-and-carry sales are created in Commerce Headquarters and Commerce Headquarters more accurately reflects your store's inventory.</span></span>
- <span data-ttu-id="d2c57-196">**Produkttilgjengelighet** – Denne jobben oppretter et øyeblikksbilde av lageret fra Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="d2c57-196">**Product availability** – This job creates the snapshot of inventory from Commerce Headquarters.</span></span>
- <span data-ttu-id="d2c57-197">**1130 (Produkttilgjengelighet)** – Denne jobben finnes på siden **Distribusjonsplaner**, og bør kjøres umiddelbart etter jobben **Produkttilgjengelighet**.</span><span class="sxs-lookup"><span data-stu-id="d2c57-197">**1130 (Product availability)** – This job is found on the **Distribution schedules** page and should be run immediately after the **Product availability** job.</span></span> <span data-ttu-id="d2c57-198">Denne jobben transporterer lagerutvalgsdata fra Commerce Headquarters til kanaldatabasene.</span><span class="sxs-lookup"><span data-stu-id="d2c57-198">This job transports the inventory snapshot data from Commerce Headquarters to the channel databases.</span></span>

> [!NOTE]
> <span data-ttu-id="d2c57-199">Av hensyn til ytelsen vil beregningen bruke en hurtigbuffer for å finne ut om det er gått lang nok tid til å rettferdiggjøre kjøring av logikken på nytt, når beregninger av beholdningstilgjengelighet på kanalsiden brukes til å lage en forespørsel om beholdningstilgjengelighet ved hjelp av API-er for e-handel eller den nye beholdningslogikken på POS-kanalsiden.</span><span class="sxs-lookup"><span data-stu-id="d2c57-199">For performance reasons, when channel-side inventory availability calculations are used to make an inventory availability request using the e-Commerce API's or the new POS channel-side inventory logic, the calculation uses a cache to determine whether enough time has passed to justify running the calculation logic again.</span></span> <span data-ttu-id="d2c57-200">Standard hurtigbuffer er satt til 60 sekunder.</span><span class="sxs-lookup"><span data-stu-id="d2c57-200">The default cache is set to 60 seconds.</span></span> <span data-ttu-id="d2c57-201">Du har for eksempel slått på beregning på kanalsiden for butikken og vist lagerbeholdningen for et produkt på siden oppslags **Beholdningsoppslag**.</span><span class="sxs-lookup"><span data-stu-id="d2c57-201">For example, you turned on channel-side calculation for your store and viewed the on-hand inventory for a product on the **Inventory lookup** page.</span></span> <span data-ttu-id="d2c57-202">Hvis én enhet av produktet deretter blir solgt, vil ikke siden **Beholdningsoppslag** vise den reduserte beholdningen før hurtigbufferen er tømt.</span><span class="sxs-lookup"><span data-stu-id="d2c57-202">If one unit of the product is then sold, the **Inventory lookup** page won't show the reduced inventory until the cache has been cleared.</span></span> <span data-ttu-id="d2c57-203">Når brukere har postert transaksjoner i POS, skal de vente 60 sekunder før de kontrollerer at lagerbeholdningen er redusert.</span><span class="sxs-lookup"><span data-stu-id="d2c57-203">After users post transactions in POS, they should wait 60 seconds before they verify that the on-hand inventory has been reduced.</span></span>

<span data-ttu-id="d2c57-204">Hvis forretnings krever mindre buffertid, kan du kontakte kundestøtterepresentanten for å få hjelp.</span><span class="sxs-lookup"><span data-stu-id="d2c57-204">If your business scenario requires a smaller cache time, contact your product support representative for help.</span></span>
