---
title: Beregne lagertilgjengelighet for detaljhandelskanaler
description: Dette emnet beskriver hvordan et firma kan bruke Microsoft Dynamics 365 Commerce til å vise estimert beholdningstilgjengelighet for produkter i nett- og butikkanaler.
author: hhainesms
ms.date: 04/23/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: v-chgri
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: hhaines
ms.search.validFrom: 2020-02-11
ms.dyn365.ops.version: Release 10.0.10
ms.openlocfilehash: fdf6df7e393bcc401e770bd1b8afcaedcadc2660
ms.sourcegitcommit: 593438a145672c55ff6a910eabce2939300b40ad
ms.translationtype: HT
ms.contentlocale: nb-NO
ms.lasthandoff: 04/23/2021
ms.locfileid: "5937440"
---
# <a name="calculate-inventory-availability-for-retail-channels"></a><span data-ttu-id="98616-103">Beregne lagertilgjengelighet for detaljhandelskanaler</span><span class="sxs-lookup"><span data-stu-id="98616-103">Calculate inventory availability for retail channels</span></span>

[!include [banner](../includes/banner.md)]
[!include [banner](includes/preview-banner.md)]

<span data-ttu-id="98616-104">Dette emnet beskriver hvordan et firma kan bruke Microsoft Dynamics 365 Commerce til å vise estimert beholdningstilgjengelighet for produkter i nett- og butikkanaler.</span><span class="sxs-lookup"><span data-stu-id="98616-104">This topic describes how a company can use Microsoft Dynamics 365 Commerce to view estimated on-hand availability for products in the online and store channels.</span></span>

## <a name="accuracy-of-inventory-availability"></a><span data-ttu-id="98616-105">Nøyaktighet for lagertilgjengelighet</span><span class="sxs-lookup"><span data-stu-id="98616-105">Accuracy of inventory availability</span></span>

<span data-ttu-id="98616-106">Commerce bruker flere servere og databaser for å sikre skalerbarhet og ytelse.</span><span class="sxs-lookup"><span data-stu-id="98616-106">Commerce uses multiple servers and databases to ensure scalability and performance.</span></span> <span data-ttu-id="98616-107">Det er derfor viktig at du forstår at de tilgjengelige beholdningsverdiene som gis via POS-programmet (salgssted), e-Commerce API-ene for beholdningstilgjengelighet (APIer) og lagerbeholdningssidene i Commerce Headquarters ikke kan være 100 prosent nøyaktig i sanntid.</span><span class="sxs-lookup"><span data-stu-id="98616-107">Therefore, it's important that you understand that the available inventory values that are provided through the point of sale (POS) application, the e-commerce inventory availability application programming interfaces (APIs), and the on-hand inventory pages in Commerce headquarters might not be 100 percent accurate in real time.</span></span> <span data-ttu-id="98616-108">Hvis transaksjoner som er opprettet for produkter i nett- eller butikkanalen ennå ikke er synkronisert med Headquarters, kan det hende at lagerbeholdningssidene i Headquarters ikke viser en nøyaktig lagerverdi i sanntid for disse produktene.</span><span class="sxs-lookup"><span data-stu-id="98616-108">If transactions that are created for products in the online or store channel haven't yet been synced to headquarters, the on-hand inventory pages in headquarters might not show an accurate real-time inventory value for those products.</span></span> <span data-ttu-id="98616-109">Hvis du har konfigurert firmaet slik at brukere i Headquarters eller andre integrerte programmer kan selge, motta, returnere eller på annen måte justere lageret ut av en butikk eller et elektronisk lager, kan det hende at salgsstedet eller den elektroniske kanalen ikke har all informasjon som kreves for å vise nøyaktige sanntidsverdier for varer.</span><span class="sxs-lookup"><span data-stu-id="98616-109">Conversely, if you configured your company so that users in headquarters or other integrated applications can sell, receive, return, or otherwise adjust inventory out of a store or online warehouse, the POS or online channel might not have all the information that is required to show accurate real-time values for items.</span></span>

<span data-ttu-id="98616-110">Det er viktig å forstå at alle tilgjengelige lagerbeholdningsdata som oppgis i løpet av driftsdagen, regnes som en anslått verdi.</span><span class="sxs-lookup"><span data-stu-id="98616-110">It's critical to understand that all on-hand availability data that is provided during the operational day is considered an estimated value.</span></span> <span data-ttu-id="98616-111">Hvis du prøver å sammenligne lagerbeholdningsinformasjonen som programmet har, med faktisk fysisk lager på hyllene, eller hvis du prøver å sammenligne lagerbeholdnings verdiene som vises i salgsstedet med lagerbeholdningsdataene du finner for det samme lageret i Headquarters, kan verdiene være forskjellige.</span><span class="sxs-lookup"><span data-stu-id="98616-111">Therefore, if you try to compare the on-hand inventory information that the application provides with actual physical inventory on the shelves, or if you try to compare the on-hand values that are shown in POS with the on-hand data that you find for the same warehouse in headquarters, the values might differ.</span></span> <span data-ttu-id="98616-112">Denne forskjellen i løpet av driftsdagen er forventet og må ikke regnes som et problem.</span><span class="sxs-lookup"><span data-stu-id="98616-112">This difference during the operational day is expected and should not be considered an issue.</span></span> <span data-ttu-id="98616-113">Hvis du vil revidere data og kontrollere at verdiene som oppgis på salgsstedet, i API-ene og i headquarters, samsvarer med de faktiske fysiske enhetene du finner på butikken eller i lagerhyllene, er det best å gjøre det etter at kanaloperasjonene er stoppet for dagen, og alle transaksjoner er riktig synkronisert mellom headquarters og kanalene.</span><span class="sxs-lookup"><span data-stu-id="98616-113">If you want to audit data and make sure that the values provided in POS, APIs, and headquarters match the actual physical units that you find on your store or warehouse shelves, the best time to do it is after channel operations have stopped for the day and all transactions have been correctly synced between headquarters and the channels.</span></span>

## <a name="channel-side-inventory-calculation"></a><span data-ttu-id="98616-114">Lagerberegning på kanalsiden</span><span class="sxs-lookup"><span data-stu-id="98616-114">Channel-side inventory calculation</span></span>

<span data-ttu-id="98616-115">Lagerberegningen på kanalsiden er en mekanisme som tar de siste kjente kanallagerdataene i Commerce Headquarters som en basislinje og deretter faktorer i flere lagerendringer som oppstod på kanalsiden, som ikke er inkludert i denne basislinjen for å beregne en forhåndsberegnet lagerbeholdning i nær sanntid.</span><span class="sxs-lookup"><span data-stu-id="98616-115">The channel-side inventory calculation is a mechanism that takes the last-known channel inventory data in Commerce headquarters as a baseline, and then factors in additional inventory changes that occurred on the channel side that aren't included in that baseline to calculate a near-real-time estimated on-hand inventory.</span></span> 

<span data-ttu-id="98616-116">Følgende lagerendringer vurderes for øyeblikket i logikken for lagerberegning på kanalsiden:</span><span class="sxs-lookup"><span data-stu-id="98616-116">The following inventory changes are currently considered in the channel-side inventory calculation logic:</span></span>

- <span data-ttu-id="98616-117">Lager solgt via hentesalgstransaksjoner i butikk</span><span class="sxs-lookup"><span data-stu-id="98616-117">Inventory sold through cash-and-carry orders in store</span></span>
- <span data-ttu-id="98616-118">Lager solgt via kundeordrer i butikk eller online-kanal</span><span class="sxs-lookup"><span data-stu-id="98616-118">Inventory sold through customer orders in store or online channel</span></span>
- <span data-ttu-id="98616-119">Lager returnert til butikk</span><span class="sxs-lookup"><span data-stu-id="98616-119">Inventory returned to store</span></span>
- <span data-ttu-id="98616-120">Lager oppfylt (plukk, pakke, forsendelse) fra butikklager</span><span class="sxs-lookup"><span data-stu-id="98616-120">Inventory fulfilled (pick, pack, ship) from store warehouse</span></span>

<span data-ttu-id="98616-121">Før du kan bruke lagerberegningen på kanalsiden, må du sende et periodisk øyeblikksbilde av lagerdata fra hovedkontoret som opprettes av **Produkttilgjengelighet**-jobben, til kanaldatabasene.</span><span class="sxs-lookup"><span data-stu-id="98616-121">To use the channel-side inventory calculation, as a prerequisite a periodic snapshot of inventory data from headquarters created by the **Product availability** job must be sent to the channel databases.</span></span> <span data-ttu-id="98616-122">Det statiske utvalget representerer informasjonen som Headquarters har om beholdningstilgjengelighet for en bestemt kombinasjon av et produkt eller en produktvariant og et lager.</span><span class="sxs-lookup"><span data-stu-id="98616-122">The snapshot represents the information that headquarters has about inventory availability for a specific combination of a product or product variant and a warehouse.</span></span> <span data-ttu-id="98616-123">Det omfatter bare lagertransaksjonene som ble behandlet og postert i Headquarters da øyeblikksbildet ble tatt, og det kan hende at det ikke er 100 prosent nøyaktig i sanntid på grunn av den konstante salgsbehandlingen som skjer på tvers av distribuerte servere.</span><span class="sxs-lookup"><span data-stu-id="98616-123">It includes only the inventory transactions that were processed and posted in headquarters at the time when the snapshot was taken, and it might not be 100 percent accurate in real time because of the constant sales processing that occurs across distributed servers.</span></span>

- <span data-ttu-id="98616-124">Hvis beholdningen ble solgt for et produkt i en butikk via hentesalgs- eller asynkront kundeordresalg i POS-programmet, har ikke Headquarters direkte informasjon om den tilknyttede lageravgangstransaksjonen for salget.</span><span class="sxs-lookup"><span data-stu-id="98616-124">If inventory was sold for a product in a store through a cash-and-carry or asynchronous customer order sale in the POS application, headquarters won't immediately have information about the related inventory issue transaction for the sale.</span></span> <span data-ttu-id="98616-125">Headquarters vil ha informasjon om beholdningen som er solgt for disse typene butikksalg, bare etter at P-jobben laster opp den tilknyttede transaksjonen fra butikkens kanaldatabase til Headquarters, og de tilknyttede salgsordrene opprettes via utdragspostering eller posteringsprosessene for fordelingsfeed.</span><span class="sxs-lookup"><span data-stu-id="98616-125">Headquarters will have information about the inventory that is sold for these types of store sales only after the P-job uploads the related transaction from the store's channel database into headquarters and the related sales orders are created through statement posting or the trickle feed posting processes.</span></span> <span data-ttu-id="98616-126">Prosessen med å opprette ordren i Headquarters oppretter de tilknyttede beholdningstransaksjonene.</span><span class="sxs-lookup"><span data-stu-id="98616-126">The process of creating the orders in headquarters creates the related inventory transactions.</span></span> 
- <span data-ttu-id="98616-127">For ordrer for e-handelskanalen har Headquarters bare informasjon om beholdningstransaksjonene etter at transaksjonene er sendt til Headquarters via P-jobben og ordresynkroniseringsprosessen er fullført.</span><span class="sxs-lookup"><span data-stu-id="98616-127">For e-commerce channel orders, headquarters has information about the inventory transactions only after the transactions are sent to headquarters through the P-job and the order synchronization process is completed.</span></span>

<span data-ttu-id="98616-128">Følg denne fremgangsmåten for å ta et øyeblikksbilde av lager i Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="98616-128">To take a snapshot of inventory in Commerce headquarters, follow these steps.</span></span>

1. <span data-ttu-id="98616-129">Gå til **Retail og Commerce \> IT for Retail og Commerce \> Produkter og beholdning \> Produkttilgjengelighet**.</span><span class="sxs-lookup"><span data-stu-id="98616-129">Go to **Retail and Commerce \> Retail and Commerce IT \> Products and inventory \> Product availability**.</span></span>
1. <span data-ttu-id="98616-130">Velg **OK** for å kjøre jobben **Produkttilgjengelighet**.</span><span class="sxs-lookup"><span data-stu-id="98616-130">Select **OK** to run the **Product availability** job.</span></span> <span data-ttu-id="98616-131">Du kan også planlegge denne jobben, slik at den kjøres i et parti.</span><span class="sxs-lookup"><span data-stu-id="98616-131">You can also schedule this job to run in batch.</span></span>

<span data-ttu-id="98616-132">Når jobben **Produkttilgjengelighet** er ferdig kjørt, må dataene som ble tatt opp, sendes til kanaldatabasene, slik at det siste statiske utvalget av Headquarters-beholdningen kan vurderes i beregningen av den estimerte lagerbeholdningen.</span><span class="sxs-lookup"><span data-stu-id="98616-132">After the **Product availability** job has finished running, the data that was captured must be pushed to the channel databases, so that the latest headquarters inventory snapshot can be considered in the channel-side calculation of estimated on-hand inventory.</span></span>

<span data-ttu-id="98616-133">Følg denne fremgangsmåten for å synkronisere øyeblikksbildedata fra hovedkontoret til kanaldatabasene.</span><span class="sxs-lookup"><span data-stu-id="98616-133">To sync snapshot data from headquarters to your channel databases, follow these steps.</span></span>

1. <span data-ttu-id="98616-134">Gå til **Detaljhandel og handel \> IT for detaljhandel og handel \> Distribusjonsplan**.</span><span class="sxs-lookup"><span data-stu-id="98616-134">Go to **Retail and Commerce \> Retail and Commerce IT \> Distribution schedule**.</span></span>
1. <span data-ttu-id="98616-135">Kjør jobben **1130** (**Produkttilgjengelighet**) for å synkronisere dataene fra det statiske utvalget som jobben **Produkttilgjengelighet** opprettet fra Headquarters til kanaldatabasene dine.</span><span class="sxs-lookup"><span data-stu-id="98616-135">Run the **1130** (**Product availability**) job to sync the snapshot data that the **Product availability** job has created from headquarters to your channel databases.</span></span>

## <a name="inventory-availability-apis-for-e-commerce"></a><span data-ttu-id="98616-136">API-er for lagertilgjengelighet for e-handel</span><span class="sxs-lookup"><span data-stu-id="98616-136">Inventory availability APIs for e-commerce</span></span>

<span data-ttu-id="98616-137">Commerce inneholder følgende APIer for e-handelscenarier for å spørre etter lagertilgjengelighet for et produkt:</span><span class="sxs-lookup"><span data-stu-id="98616-137">Commerce provides the following APIs for e-commerce scenarios to query inventory availability of a product:</span></span>

- <span data-ttu-id="98616-138">**GetEstimatedAvailability** – Bruk denne API-en til å spørre etter lagerbeholdning for et produkt eller en produktvariant i det elektroniske kanallageret eller lagrene som er koblet til den elektroniske kanalens innfrielsesgruppe.</span><span class="sxs-lookup"><span data-stu-id="98616-138">**GetEstimatedAvailability** – Use this API to query inventory for a product or product variant in the online channel warehouse or warehouses that are linked to the online channel's fulfillment group.</span></span>
- <span data-ttu-id="98616-139">**GetEstimatedProductWarehouseAvailability** – Bruk denne API-en til å spørre om beholdning for et produkt eller en produktvariant fra et bestemt lager.</span><span class="sxs-lookup"><span data-stu-id="98616-139">**GetEstimatedProductWarehouseAvailability** – Use this API to query inventory for a product or product variant from a specific warehouse.</span></span>

> [!NOTE]
> <span data-ttu-id="98616-140">Disse API-ene erstatter API-ene **GetProductAvailabilities** og **GetAvailableInventoryNearby** i Commerce-versjon 10.0.7 og tidligere.</span><span class="sxs-lookup"><span data-stu-id="98616-140">These APIs replace the **GetProductAvailabilities** and **GetAvailableInventoryNearby** APIs in Commerce release 10.0.7 and earlier.</span></span>

<span data-ttu-id="98616-141">Begge APIer brukes internt i beregningslogikken på kanalsiden og returner estimert **fysisk tilgjengelig** antall, **totalt tilgjengelig antall** , **måleenhet (UoM)** og **lagernivå** for det ønskede produktet og lageret.</span><span class="sxs-lookup"><span data-stu-id="98616-141">Both APIs internally use the channel-side calculation logic and return estimated **physical available** quantity, **total available** quantity, **unit of measure (UoM)**, and **inventory level** for the requested product and warehouse.</span></span> <span data-ttu-id="98616-142">De returnerte verdiene kan vises på ditt e-handelsområde hvis du vil, eller de kan brukes til å utløse andre forretningslogikker på ditt e-handelsområde.</span><span class="sxs-lookup"><span data-stu-id="98616-142">The returned values can be shown on your e-commerce site if you want, or they can be used to trigger other business logic on your e-commerce site.</span></span> <span data-ttu-id="98616-143">Du kan for eksempel hindre innkjøp av produkter med et lager uten lagernivå.</span><span class="sxs-lookup"><span data-stu-id="98616-143">For example, you can prevent the purchase of products with an "out of stock" inventory level.</span></span>

<span data-ttu-id="98616-144">Selv om andre API-er som er tilgjengelige på Commerce-serveren, kan gå direkte til headquarters for å hente lagerbeholdningsantall for produkter, anbefaler vi ikke at de brukes i et miljø med e-handel, på grunn av potensielle ytelsesproblemer og den relaterte innvirkningen som disse hyppige forespørslene kan ha på Headquarters-serverne.</span><span class="sxs-lookup"><span data-stu-id="98616-144">Although other APIs that are available in Commerce can go directly to headquarters to fetch on-hand quantities for products, we don't recommend that they be used in an e-commerce environment because of potential performance issues and the impact that these frequent requests can have on your headquarters servers.</span></span> <span data-ttu-id="98616-145">Med beregning på kanalsiden kan de to APIene som er nevnt ovenfor, i tillegg gi et mer nøyaktig estimat over tilgjengeligheten til et produkt ved å ta hensyn til transaksjonene som er opprettet i kanalene som ennå ikke er kjent for headquarters.</span><span class="sxs-lookup"><span data-stu-id="98616-145">Additionally, with channel-side calculation, the two APIs mentioned above can provide a more accurate estimate of a product's availability by taking into account the transactions created in the channels that aren’t yet known to headquarters.</span></span>

<span data-ttu-id="98616-146">For å bruke de to APIene må du aktivere funksjonen **Beregning av optimalisert produkttilgjengelighet** via arbeidsområdet **Funksjonsbehandling** i hovedkontoret.</span><span class="sxs-lookup"><span data-stu-id="98616-146">To use the two APIs, you must enable the **Optimized product availability calculation** feature through the **Feature management** workspace in headquarters.</span></span> <span data-ttu-id="98616-147">Hvis de elektroniske kanalene og butikkanalene bruker samme oppfyllelseslagrene, må du også aktivere funksjonen for **utvidet logikk for lagerberegning på e-handelskanalene** for å ha beregningslogikken på kanalsiden i de to APIene for å angi faktorer i de uposterte transaksjonene (kontantoverføring, kundeordrer og returer) som opprettes i butikkanalen.</span><span class="sxs-lookup"><span data-stu-id="98616-147">If your online and store channels use the same fulfillment warehouses, you must also enable the **Enhanced e-Commerce channel-side inventory calculation logic** feature to have the channel-side calculation logic within the two APIs to factor in the unposted transactions (cash-and-carry, customer orders, returns) created in the store channel.</span></span> <span data-ttu-id="98616-148">Du må kjøre jobben **1070** (**Kanalkonfigurasjon**) etter at du har aktivert disse funksjonene.</span><span class="sxs-lookup"><span data-stu-id="98616-148">You will need to run the **1070** (**Channel configuration**) job after enabling these features.</span></span>

<span data-ttu-id="98616-149">Følg denne fremgangsmåten for å definere hvordan produktantallet skal returneres i API-resultatet.</span><span class="sxs-lookup"><span data-stu-id="98616-149">To define how product quantity should be returned in the API output, follow these steps.</span></span>

1. <span data-ttu-id="98616-150">Gå til **Detaljhandel og handel \> Hovedkvarteroppsett \> Parametere \> Handelsparametere**.</span><span class="sxs-lookup"><span data-stu-id="98616-150">Go to **Retail and Commerce \> Headquarters setup \> Parameters \> Commerce parameters**.</span></span>
1. <span data-ttu-id="98616-151">Velg kategorien **Lager**. Deretter konfigurerer du verdien for innstillingen **Antall i API-utdata** i hurtigfanen for **Lagertilgjengelighet for APIer for e-Commerce**.</span><span class="sxs-lookup"><span data-stu-id="98616-151">Select the **Inventory** tab, and then on the **Inventory availability APIs for e-Commerce** FastTab configure the value of the **Quantity in API output** setting.</span></span>
1. <span data-ttu-id="98616-152">Kjør jobben **1070** (**Kanalkonfigurasjon**) for å synkronisere den siste innstillingen for kanalene.</span><span class="sxs-lookup"><span data-stu-id="98616-152">Run the **1070** (**Channel configuration**) job to sync the latest setting to channels.</span></span>

<span data-ttu-id="98616-153">Innstillingen **Antall i API-utdata** gir tre alternativer:</span><span class="sxs-lookup"><span data-stu-id="98616-153">The **Quantity in API output** setting provides three options:</span></span>

- <span data-ttu-id="98616-154">**Returlagerantall** - Fysisk tilgjengelig og totalt tilgjengelig antall for et forespurt produkt returneres i API-utdata.</span><span class="sxs-lookup"><span data-stu-id="98616-154">**Return inventory quantity** - Physical available and total available quantity of a requested product are returned in API output.</span></span>
- <span data-ttu-id="98616-155">**Returlagerantall som trekker fra lagerbufferen** - Antallet som returneres i API-utdataene, justeres ved å trekke fra lagerbufferverdien.</span><span class="sxs-lookup"><span data-stu-id="98616-155">**Return inventory quantity subtracting inventory buffer** - The quantity returned in the API output is adjusted by subtracting the inventory buffer value.</span></span> <span data-ttu-id="98616-156">Hvis du vil ha mer informasjon om lagerbufferen, kan du se [Konfigurere lagerbuffere og lagernivåer](inventory-buffers-levels.md).</span><span class="sxs-lookup"><span data-stu-id="98616-156">For more information about the inventory buffer, see [Configure inventory buffers and inventory levels](inventory-buffers-levels.md).</span></span>
- <span data-ttu-id="98616-157">**Ikke returlagerantall** - Bare lagernivået returneres i API-utdataene.</span><span class="sxs-lookup"><span data-stu-id="98616-157">**Not return inventory quantity** - Only the inventory level is returned in the API output.</span></span> <span data-ttu-id="98616-158">Hvis du vil ha mer informasjon om lagernivå, kan du se [Konfigurere lagerbuffere og lagernivåer](inventory-buffers-levels.md).</span><span class="sxs-lookup"><span data-stu-id="98616-158">For more information about inventory levels, see [Configure inventory buffers and inventory levels](inventory-buffers-levels.md).</span></span>

<span data-ttu-id="98616-159">Du kan bruke `QuantityUnitTypeValue`-API-parameteren til å angi enhetstypen du vil at APIene skal returnere antall i.</span><span class="sxs-lookup"><span data-stu-id="98616-159">You can use the `QuantityUnitTypeValue` API parameter to specify the unit type in which you would like the APIs to return quantity.</span></span> <span data-ttu-id="98616-160">Denne parameteren støtter alternativene **lagerenheten** (standard), **innkjøpsenhet** og **salgsenhet**.</span><span class="sxs-lookup"><span data-stu-id="98616-160">This parameter supports the **inventory unit** (default), **purchase unit**, and **sell unit** options.</span></span> <span data-ttu-id="98616-161">Det returnerte antallet avrundes til den definerte presisjonen i tilsvarende måleenhet (måleenhet) i hovedkontoret.</span><span class="sxs-lookup"><span data-stu-id="98616-161">The returned quantity is rounded to the defined precision of the corresponding unit of measure (UOM) in headquarters.</span></span>

<span data-ttu-id="98616-162">**GetEstimatedAvailability**-API-en tilbyr følgende inndataparametere som støtter forskjellige spørringsscenarier:</span><span class="sxs-lookup"><span data-stu-id="98616-162">The **GetEstimatedAvailability** API offers the following input parameters to support different query scenarios:</span></span>

- <span data-ttu-id="98616-163">`DefaultWarehouseOnly` – Bruk denne parameteren til å spørre etter lagerbeholdning for et produkt i den elektroniske k+analens standardlager.</span><span class="sxs-lookup"><span data-stu-id="98616-163">`DefaultWarehouseOnly` - Use this parameter to query inventory for a product in the online channel's default warehouse.</span></span> 
- <span data-ttu-id="98616-164">`FilterByChannelFulfillmentGroup` og `SearchArea` - Bruk disse to parameterne til å spørre etter lager for et produkt fra alle plukklokasjoner innenfor et bestemt søkeområde, basert på `longitude`, `latitude` og `radius`.</span><span class="sxs-lookup"><span data-stu-id="98616-164">`FilterByChannelFulfillmentGroup` and `SearchArea` - Use these two parameters to query inventory for a product from all pickup locations within a specific search area, based on `longitude`, `latitude`, and `radius`.</span></span> 
- <span data-ttu-id="98616-165">`FilterByChannelFulfillmentGroup` og `DeliveryModeTypeFilterValue` - Bruk disse to parameterne til å spørre etter lagerbeholdning for et produkt fra bestemte lagre som er koblet til innfrielsesgruppen for en online-kanal, og er konfigurert til å støtte bestemte leveringsmåter.</span><span class="sxs-lookup"><span data-stu-id="98616-165">`FilterByChannelFulfillmentGroup` and `DeliveryModeTypeFilterValue` - Use these two parameters to query inventory for a product from specific warehouses that are linked to an online channel's fulfillment group and are configured to support certain modes of delivery.</span></span> <span data-ttu-id="98616-166">Parameteren `DeliveryModeTypeFilterValue` støtter alternativene **alle** (standard), **forsendelse** og **henting**.</span><span class="sxs-lookup"><span data-stu-id="98616-166">The `DeliveryModeTypeFilterValue` parameter supports the **all** (default), **shipping**, and **pickup** options.</span></span> <span data-ttu-id="98616-167">I et scenario der en nettordre kan oppfylles fra flere forsendelseslagre, kan du for eksempel bruke disse to parameterne til å utføre spørringer mot tilgjengelighet av et produkts lager i alle disse forsendelseslagrene.</span><span class="sxs-lookup"><span data-stu-id="98616-167">For example, in a scenario where an online order can be fulfilled from multiple shipping warehouses, you can use these two parameters to query a product's inventory availability in all of those shipping warehouses.</span></span> <span data-ttu-id="98616-168">API-en i dette tilfellet returnerer produktets beholdningsantall og lagernivå i hvert forsendelseslager, pluss et aggregert antall og et akkumulert lagernivå fra alle forsendelseslagre i spørringsområdet.</span><span class="sxs-lookup"><span data-stu-id="98616-168">The API in this case returns the product's on-hand quantity and inventory level in each of the shipping warehouses, plus an aggregated quantity and an aggregated inventory level from all shipping warehouses in the query scope.</span></span>
 
<span data-ttu-id="98616-169">Commerce-modulene kjøpsboks, butikkvelger, ønskerliste, handlekurv og handlekurvikon bruker APIene og parameterne som er nevnt ovenfor, for å vise lagernivåmeldinger for hele e-handelområdet.</span><span class="sxs-lookup"><span data-stu-id="98616-169">The Commerce buy box, store selector, wishlist, cart, and cart icon modules consume the APIs and parameters mentioned above to display inventory level messages across the e-commerce site.</span></span> <span data-ttu-id="98616-170">Commerce-områdebygger inneholder ulike lagerinnstillinger for å kontrollere salgs- og innkjøpsvirkemåten.</span><span class="sxs-lookup"><span data-stu-id="98616-170">Commerce site builder provides various inventory settings to control merchandising and purchase behavior.</span></span> <span data-ttu-id="98616-171">For mer informasjon, se [Bruke beholdningsinnstillinger](inventory-settings.md).</span><span class="sxs-lookup"><span data-stu-id="98616-171">For more information, see [Apply inventory settings](inventory-settings.md).</span></span>

## <a name="pos-inventory-lookup-with-channel-side-calculation"></a><span data-ttu-id="98616-172">Lageroppslag for salgssted med beregning på kanalsiden</span><span class="sxs-lookup"><span data-stu-id="98616-172">POS inventory lookup with channel-side calculation</span></span>

<span data-ttu-id="98616-173">I Commerce-versjon 10.0.9 og tidligere brukte operasjonen **Beholdningsoppslag** på salgsstedet et servicekall i sanntid til Headquarters for å få beholdningsinformasjon for det valgte produktet, både for brukerens gjeldende butikk og andre butikker som er konfigurert for oppfyllelsesgruppen som en del av kanalkonfigurasjonen for butikken.</span><span class="sxs-lookup"><span data-stu-id="98616-173">In the Commerce release 10.0.9 and earlier, the **Inventory lookup** operation in POS used a real-time service call to headquarters to get inventory information for the selected product for both the user's current store and any other stores that are configured for the fulfillment group as part of the channel configuration for the store.</span></span> <span data-ttu-id="98616-174">I Commerce-versjon 10.0.10 og senere kan du slå av serviceanrop i sanntid til hovedkontoret og i stedet bruke beregning på kanalsiden på Commerce-serveren til å fastslå lagerbeholdningen som er fysisk tilgjengelig for butikken og andre lokasjoner som er definert i innfrielsesgruppen.</span><span class="sxs-lookup"><span data-stu-id="98616-174">In Commerce release 10.0.10 and later, you can turn off real-time service calls to headquarters and instead use channel-side calculation on the Commerce server to determine the on-hand inventory that is physically available for the store and any other locations that are defined in the fulfillment group.</span></span> <span data-ttu-id="98616-175">Denne kanalberegnede lagerkonfigurasjonen er også nyttig for steder der Internett-tilkoblingen er upålitelig, fordi du ikke behøver å være tilkoblet for å få lageroppslag fra hovedkvarteret.</span><span class="sxs-lookup"><span data-stu-id="98616-175">This channel-calculated inventory configuration is also useful for locations where internet connectivity is unreliable, because you don't have to be online to get inventory lookups headquarters.</span></span>

<span data-ttu-id="98616-176">Når beregning på kanalsiden er riktig konfigurert og administrert, kan det gi et mer pålitelig estimat over gjeldende butikkbeholdning, fordi dette bruker transaksjonsdataene som er i handelskanaldatabasen, men som hovedkvarteret kanskje ikke har informasjon om ennå.</span><span class="sxs-lookup"><span data-stu-id="98616-176">When channel-side calculation is correctly configured and managed, it can provide a more reliable estimate of the current store inventory because it uses the transactional data that is in the Commerce channel database but that headquarters might not yet have information about.</span></span> <span data-ttu-id="98616-177">Hvis du for eksempel bruker det eksisterende servicekallet i sanntid for lageroppslag på salgsstedet, vil ikke hovedkvarteret ennå ha informasjon om kontantsalg som akkurat har skjedd for et produkt.</span><span class="sxs-lookup"><span data-stu-id="98616-177">For example, if you use the existing real-time service call for inventory lookups in POS, headquarters probably won't yet have information about a cash-and-carry sale that just occurred for a product.</span></span> <span data-ttu-id="98616-178">Derfor vil lagerbeholdningsverdien som er returnert av hovedkvarteret for dette produktet, sannsynligvis overskride butikkens faktiske lagerbeholdning med én enhet.</span><span class="sxs-lookup"><span data-stu-id="98616-178">Therefore, the on-hand inventory value that headquarters returns for that product will probably exceed the store's actual on-hand inventory by one unit.</span></span> <span data-ttu-id="98616-179">Hvis du imidlertid bruker beregning på kanalsiden, kan kontantsalget faktoreres inn i beregningen og trekkes fra beholdningsverdien som vises.</span><span class="sxs-lookup"><span data-stu-id="98616-179">However, if you use channel-side calculation, the cash-and-carry sale can be factored into the calculation and deducted from the on-hand value that is shown.</span></span> <span data-ttu-id="98616-180">Selv om verdiene som både kanalsiden og servicekallet i sanntid oppgir, bare er estimater av lagerbeholdningen, er verdien som beregning på kanalsiden oppgir, mye mer sannsynlig å være nøyaktig for den gjeldende butikken.</span><span class="sxs-lookup"><span data-stu-id="98616-180">Although the values that both the channel-side calculation and the real-time service call provide are only estimates of on-hand inventory, the value that the channel-side calculation provides is much more likely to be accurate for the current store.</span></span>

<span data-ttu-id="98616-181">Følg denne fremgangsmåten for å konfigurere **Lageroppslag** for salgsstedet i hovedkontoret for å bruke beregningslogikken på kanalsiden og slå av servicekall i sanntid.</span><span class="sxs-lookup"><span data-stu-id="98616-181">To configure the POS **Inventory lookup** operation in headquarters to use the channel-side calculation logic and turn off real-time service call, follow these steps.</span></span>

1. <span data-ttu-id="98616-182">Gå til **Retail og Commerce \> Kanaloppsett \> Salgsstedsoppsett \> Salgsstedsprofiler \> Funksjonalitetsprofiler**.</span><span class="sxs-lookup"><span data-stu-id="98616-182">Go to **Retail and Commerce \> Channel setup \> POS setup \> POS profiles \> Functionality profiles**.</span></span>
1. <span data-ttu-id="98616-183">Velg en funksjonalitetsprofil.</span><span class="sxs-lookup"><span data-stu-id="98616-183">Select a functionality profile.</span></span>
1. <span data-ttu-id="98616-184">I hurtigfanen **Funksjoner**, i delen **Beregning av lagertilgjengelighet** endrer du verdien i feltet **Modus for beregning av lagertilgjengelighet** fra **Sanntidstjeneste** til **Kanal**.</span><span class="sxs-lookup"><span data-stu-id="98616-184">On the **Functions** FastTab, in the **Inventory availability calculation** section, change the value of **Inventory availability calculation mode** from **Real time service** to **Channel**.</span></span> <span data-ttu-id="98616-185">Som standard bruker alle funksjonalitetsprofiler servicekall i sanntid.</span><span class="sxs-lookup"><span data-stu-id="98616-185">By default, all functionality profiles use real-time service calls.</span></span> <span data-ttu-id="98616-186">Du må endre verdien i dette feltet hvis du vil bruke logikken for beregning på kanalsiden.</span><span class="sxs-lookup"><span data-stu-id="98616-186">You must change the value of this field if you want to use channel-side calculation logic.</span></span> <span data-ttu-id="98616-187">Hver detaljhandelsbutikk som er koblet til den valgte funksjonalitetsprofilen, påvirkes av denne endringen.</span><span class="sxs-lookup"><span data-stu-id="98616-187">Every retail store that is linked to the selected functionality profile will be affected by this change.</span></span>

<span data-ttu-id="98616-188">Du må deretter synkronisere endringene i kanalene via distribusjonsplanprosessen i Headquarters, ved å gjøre følgende:</span><span class="sxs-lookup"><span data-stu-id="98616-188">You must then sync the changes to the channels through the distribution schedule process in headquarters by following these steps.</span></span>

1. <span data-ttu-id="98616-189">Gå til **Detaljhandel og handel \> IT for detaljhandel og handel \> Distribusjonsplan**.</span><span class="sxs-lookup"><span data-stu-id="98616-189">Go to **Retail and Commerce \> Retail and Commerce IT \> Distribution schedule**.</span></span>
1. <span data-ttu-id="98616-190">Kjør jobben **1070** (**Kanalkonfigurasjon**).</span><span class="sxs-lookup"><span data-stu-id="98616-190">Run the **1070** (**Channel configuration**) job.</span></span>

<span data-ttu-id="98616-191">Når konfigurasjonen er fullført, bruker informasjonen som er oppgitt om fysisk tilgjengelig lager, ikke lenger et servicekall i sanntid når en bruker i POS-programmet bruker operasjonen **Lageroppslag** (standard- og matrisevisning).</span><span class="sxs-lookup"><span data-stu-id="98616-191">After the configuration is completed, the information that is provided about physically available inventory no longer uses a real-time service call when a user in the POS application uses the **Inventory lookup** operation (standard and matrix views).</span></span> <span data-ttu-id="98616-192">I stedet beregnes data om fysisk tilgjengelig lager for den gjeldende butikken og alle butikkene i oppfyllelsesgruppen på grunnlag av det siste kjente statiske utvalget som ble levert til kanaldatabasen fra Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="98616-192">Instead, data about physically available inventory for the current store and all the stores in the fulfillment group is calculated based on the last-known snapshot that was delivered to the channel database from Commerce Headquarters.</span></span> <span data-ttu-id="98616-193">Verdien for det statiske utvalget revideres ytterligere av beregningen på kanalsiden for å justere den fysisk tilgjengelige verdien, basert på andre salgs- eller returtransaksjoner som finnes for det valgte produktet i kanaldatabasen, og som ikke var inkludert i det siste synkroniserte øyeblikksbildet fra 1130-jobben.</span><span class="sxs-lookup"><span data-stu-id="98616-193">The snapshot value is further refined by the channel-side calculation to adjust the physically available value, based on additional sales or return transactions that exist for the selected product in the channel database that were not included in the last synchronized snapshot from the 1130 job.</span></span> <span data-ttu-id="98616-194">Hvis kanaldatabasen ikke inneholder transaksjonsdata for noen av lagrene eller butikkene i oppfyllelsesgruppen, inneholder den ingen ekstra transaksjoner som kan beregnes i en omberegning av verdien.</span><span class="sxs-lookup"><span data-stu-id="98616-194">If the channel database doesn't contain transactional data for any of the warehouses or stores in the fulfillment group, it contains no additional transactions that can be factored into a recalculation of the value.</span></span> <span data-ttu-id="98616-195">Derfor er det beste estimatet for lagerbeholdningen som kan vises for disse lagrene eller butikkene, dataene fra det siste kjente statiske utvalget for Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="98616-195">Therefore, the best estimate of on-hand inventory that can be shown for those warehouses or stores is the data from the last-known Commerce Headquarters snapshot.</span></span>

<span data-ttu-id="98616-196">Skjermene **Ordreoppfyllelse** i POS drar også nytte av beregningen på kanalsiden for å vise lagerbeholdning for varer når en ordreoppfyllelseslinje er valgt, og en bruker viser **Detaljer**-panelet for lagerbeholdningen for den valgte varen.</span><span class="sxs-lookup"><span data-stu-id="98616-196">The **Order fulfillment** screens of POS also leverage the channel side calculation to show on-hand inventory for items when an order fulfillment line is selected and a user views the **Details** panel for on-hand inventory for the selected item.</span></span>

## <a name="optimize-your-inventory-data"></a><span data-ttu-id="98616-197">Optimalisere beholdningsdataene</span><span class="sxs-lookup"><span data-stu-id="98616-197">Optimize your inventory data</span></span>

<span data-ttu-id="98616-198">Hvis du vil sikre det best mulige estimatet for lageret, er det viktig at du bruker følgende satsvise jobber for handel og kjører dem ofte:</span><span class="sxs-lookup"><span data-stu-id="98616-198">To ensure the best possible estimate of inventory, it's critical that you use the following Commerce batch jobs and run them frequently:</span></span>

- <span data-ttu-id="98616-199">**P-jobben** – P-jobben finnes på siden **Ddistribusjonsplaner** og bør kjøres ofte.</span><span class="sxs-lookup"><span data-stu-id="98616-199">**P-job** – The P-job is found on the **Distribution schedules** page and should be run frequently.</span></span> <span data-ttu-id="98616-200">Denne jobben bringer e-handelsordrer, asynkrone kundeordrer som POS oppretter, og kontantbestillinger som er opprettet fra kanaldatabasene, til Commerce Headquarters, slik at de kan behandles videre.</span><span class="sxs-lookup"><span data-stu-id="98616-200">This job brings e-Commerce orders, asynchronous customer orders that POS created, and cash-and-carry orders that POS created from the channel databases into Commerce Headquarters, so that they can be processed further.</span></span> <span data-ttu-id="98616-201">Før disse dataene er synkronisert fra kanalen til Commerce Headquarters, har ikke Commerce Headquarters informasjon om lagerjusteringer av produkter i lagrene som blir resultatet av disse transaksjonene.</span><span class="sxs-lookup"><span data-stu-id="98616-201">Until this data is synced from the channel to Commerce Headquarters, Commerce Headquarters has no information about inventory adjustments to products in the warehouses that result from those transactions.</span></span>
- <span data-ttu-id="98616-202">**Synkroniser ordrer** – Denne jobben behandler rå transaksjonsdata i Commerce Headquarters som P-jobben tilbyr, og konverterer e-handel og asynkrone kundeordretransaksjoner til salgsordrer i Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="98616-202">**Synchronize orders** – This job processes the raw transactional data in Commerce Headquarters that the P-job provides and converts e-Commerce and asynchronous customer order transactions into sales orders in Commerce Headquarters.</span></span> <span data-ttu-id="98616-203">Før denne jobben er behandlet og salgsordrene er opprettet, blir det ikke opprettet noen lagertransaksjoner.</span><span class="sxs-lookup"><span data-stu-id="98616-203">Until this job is processed and the sales orders are created, no inventory transactions are created.</span></span> <span data-ttu-id="98616-204">Lagerbeholdningen i Commerce Headquarters vil derfor ikke vurdere transaksjonene.</span><span class="sxs-lookup"><span data-stu-id="98616-204">Therefore, on-hand inventory in Commerce Headquarters won't consider the transactions.</span></span>
- <span data-ttu-id="98616-205">**Beregn transaksjonsutdrag satsvis** – For kontanttransaksjoner som opprettes i butikken, sikrer fordelingsfeedposteringen at lageret som er knyttet til salget, oppdateres effektivt.</span><span class="sxs-lookup"><span data-stu-id="98616-205">**Calculate transactional statements in batch** – For cash-and-carry transactions that are created in the store, the trickle feed posting process ensures that inventory that is related to the sales is updated efficiently.</span></span> <span data-ttu-id="98616-206">Hvis du vil ha den mest effektive behandlingen av lagertransaksjoner for kontant, må du konfigurere systemet til å bruke [fordelingsfeedpostering](./trickle-feed.md).</span><span class="sxs-lookup"><span data-stu-id="98616-206">To get the most efficient processing of inventory transactions for cash-and-carry orders, make sure that you configure your system to use [trickle feed posting](./trickle-feed.md).</span></span>
- <span data-ttu-id="98616-207">**Poster transaksjonsutdrag satsvis** – Denne jobben er også nødvendig for fordelingsfeedpostering.</span><span class="sxs-lookup"><span data-stu-id="98616-207">**Post transactional statements in batch** – This job is also required for trickle feed posting.</span></span> <span data-ttu-id="98616-208">Den følger etter jobben **Beregn transaksjonsutdrag satsvis**.</span><span class="sxs-lookup"><span data-stu-id="98616-208">It follows the **Calculate transactional statements in batch** job.</span></span> <span data-ttu-id="98616-209">Denne jobben posterer de beregnede utdragene systematisk, slik at salgsordrer for kontantsalg opprettes i Commerce Headquarters og Commerce Headquarters mer nøyaktig gjenspeiler butikkens lager.</span><span class="sxs-lookup"><span data-stu-id="98616-209">This job systematically posts the calculated statements, so that sales orders for cash-and-carry sales are created in Commerce Headquarters and Commerce Headquarters more accurately reflects your store's inventory.</span></span>
- <span data-ttu-id="98616-210">**Produkttilgjengelighet** – Denne jobben oppretter et øyeblikksbilde av lageret fra Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="98616-210">**Product availability** – This job creates the snapshot of inventory from Commerce Headquarters.</span></span>
- <span data-ttu-id="98616-211">**1130 (Produkttilgjengelighet)** – Denne jobben finnes på siden **Distribusjonsplaner**, og bør kjøres umiddelbart etter jobben **Produkttilgjengelighet**.</span><span class="sxs-lookup"><span data-stu-id="98616-211">**1130 (Product availability)** – This job is found on the **Distribution schedules** page and should be run immediately after the **Product availability** job.</span></span> <span data-ttu-id="98616-212">Denne jobben transporterer lagerutvalgsdata fra Commerce Headquarters til kanaldatabasene.</span><span class="sxs-lookup"><span data-stu-id="98616-212">This job transports the inventory snapshot data from Commerce Headquarters to the channel databases.</span></span>

> [!NOTE]
> - <span data-ttu-id="98616-213">Det er god praksis å kjøre **Produkttilgjengelighet** og **1130**-jobber på en timesbasis og planlegge P-jobb, synkronisere ordrer og fordelingsfeedbaserte jobber med samme eller høyere frekvens.</span><span class="sxs-lookup"><span data-stu-id="98616-213">It is a best practice to run the **Product availability** and **1130** jobs on an hourly basis, and to schedule P-job, synchronize orders, and trickle feed posting-related jobs with the same or higher frequency.</span></span>
> - <span data-ttu-id="98616-214">Av hensyn til ytelsen vil beregningen bruke en hurtigbuffer for å finne ut om det er gått lang nok tid til å rettferdiggjøre kjøring av logikken på nytt, når beregninger av beholdningstilgjengelighet på kanalsiden brukes til å lage en forespørsel om beholdningstilgjengelighet ved hjelp av API-er for e-handel eller beholdningslogikken på POS-kanalsiden.</span><span class="sxs-lookup"><span data-stu-id="98616-214">For performance reasons, when channel-side inventory availability calculations are used to make an inventory availability request using the e-Commerce API's or the POS channel-side inventory logic, the calculation uses a cache to determine whether enough time has passed to justify running the calculation logic again.</span></span> <span data-ttu-id="98616-215">Standard hurtigbuffer er satt til 60 sekunder.</span><span class="sxs-lookup"><span data-stu-id="98616-215">The default cache is set to 60 seconds.</span></span> <span data-ttu-id="98616-216">Du har for eksempel slått på beregning på kanalsiden for butikken og vist lagerbeholdningen for et produkt på siden oppslags **Beholdningsoppslag**.</span><span class="sxs-lookup"><span data-stu-id="98616-216">For example, you turned on channel-side calculation for your store and viewed the on-hand inventory for a product on the **Inventory lookup** page.</span></span> <span data-ttu-id="98616-217">Hvis én enhet av produktet deretter blir solgt, vil ikke siden **Beholdningsoppslag** vise den reduserte beholdningen før hurtigbufferen er tømt.</span><span class="sxs-lookup"><span data-stu-id="98616-217">If one unit of the product is then sold, the **Inventory lookup** page won't show the reduced inventory until the cache has been cleared.</span></span> <span data-ttu-id="98616-218">Når brukere har postert transaksjoner i POS, skal de vente 60 sekunder før de kontrollerer at lagerbeholdningen er redusert.</span><span class="sxs-lookup"><span data-stu-id="98616-218">After users post transactions in POS, they should wait 60 seconds before they verify that the on-hand inventory has been reduced.</span></span>

<span data-ttu-id="98616-219">Hvis forretnings krever mindre buffertid, kan du kontakte kundestøtterepresentanten for å få assistanse.</span><span class="sxs-lookup"><span data-stu-id="98616-219">If your business scenario requires a smaller cache time, contact your product support representative for assistance.</span></span>


[!INCLUDE[footer-include](../includes/footer-banner.md)]
