---
title: Oversikt over regnskapsintegrering for handelskanaler
description: Dette emnet gir en oversikt over funksjonene for regnskapsintegrering som er tilgjengelige i Dynamics 365 Commerce.
author: josaw
manager: annbe
ms.date: 02/01/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
ms.search.form: RetailFunctionalityProfile, RetailFormLayout, RetailParameters
audience: Application User
ms.reviewer: josaw
ms.search.region: Global
ms.search.industry: Retail
ms.author: epopov
ms.search.validFrom: 2019-1-16
ms.dyn365.ops.version: 10
ms.openlocfilehash: d766515d82e021f41e0cc0a9a877f25551817ad5
ms.sourcegitcommit: eaf330dbee1db96c20d5ac479f007747bea079eb
ms.translationtype: HT
ms.contentlocale: nb-NO
ms.lasthandoff: 02/15/2021
ms.locfileid: "5250836"
---
# <a name="overview-of-fiscal-integration-for-commerce-channels"></a><span data-ttu-id="585f9-103">Oversikt over regnskapsintegrering for handelskanaler</span><span class="sxs-lookup"><span data-stu-id="585f9-103">Overview of fiscal integration for Commerce channels</span></span>

[!include [banner](../includes/banner.md)]

## <a name="introduction"></a><span data-ttu-id="585f9-104">Innledning</span><span class="sxs-lookup"><span data-stu-id="585f9-104">Introduction</span></span>

<span data-ttu-id="585f9-105">Dette emnet er en oversikt over funksjonene for regnskapsintegrering som er tilgjengelige i Dynamics 365 Commerce.</span><span class="sxs-lookup"><span data-stu-id="585f9-105">This topic is an overview of the fiscal integration capabilities that are available in Dynamics 365 Commerce.</span></span> <span data-ttu-id="585f9-106">Regnskapsintegrering omfatter integrering med ulike regnskapsenheter og -tjenester som gir mulighet for bilagsregistrering av salg i samsvar med lokale regnskapslover som er rettet mot å hindre avgiftssvindel i detaljhandelen.</span><span class="sxs-lookup"><span data-stu-id="585f9-106">Fiscal integration includes integration with various fiscal devices and services that enable fiscal registration of sales in accordance with local fiscal laws that are aimed at preventing tax fraud in the retail industry.</span></span> <span data-ttu-id="585f9-107">Her er noen vanlige scenarier som kan dekkes ved å bruke regnskapsintegrering:</span><span class="sxs-lookup"><span data-stu-id="585f9-107">Here are some typical scenarios that can be covered by using fiscal integration:</span></span>

- <span data-ttu-id="585f9-108">Registrer et salg på en regnskapsenhet som er koblet til salgsstedet, for eksempel en bilagsskriver, og skriv ut en bilagskvittering for kunden.</span><span class="sxs-lookup"><span data-stu-id="585f9-108">Register a sale on a fiscal device that is connected to point of sale (POS), such as a fiscal printer, and print a fiscal receipt for the customer.</span></span>
- <span data-ttu-id="585f9-109">Send informasjon som er knyttet til salg og returer som er fullført i Retail POS, sikkert til en ekstern webtjeneste som styres av skattemyndighetene.</span><span class="sxs-lookup"><span data-stu-id="585f9-109">Securely submit information that is related to sales and returns that are completed in Retail POS to an external web-service that is operated by the tax authority.</span></span>
- <span data-ttu-id="585f9-110">Bidra til å sikre at salgstransaksjonsdata ikke kan endres, gjennom digitale signaturer.</span><span class="sxs-lookup"><span data-stu-id="585f9-110">Help guarantee inalterability of sales transaction data through digital signatures.</span></span>

<span data-ttu-id="585f9-111">Funksjonen for regnskapsintegrering er et rammeverk som gir en felles løsning for videre utvikling og tilpassing av integreringen mellom Retail POS og regnskapsenheter og -tjenester.</span><span class="sxs-lookup"><span data-stu-id="585f9-111">The fiscal integration functionality is a framework that provides a common solution for further development and customization of the integration between Retail POS and fiscal devices and services.</span></span> <span data-ttu-id="585f9-112">Funksjonen inneholder også eksempler på regnskapsintegrering som støtter grunnleggende scenarioer for bestemte land eller områder, og som fungerer med bestemte regnskapsenheter eller -tjenester.</span><span class="sxs-lookup"><span data-stu-id="585f9-112">The functionality also includes fiscal integration samples that support basic scenarios for specific countries or regions, and that work with specific fiscal devices or services.</span></span> <span data-ttu-id="585f9-113">Et eksempel på regnskapsintegrering består av flere utvidelser for handelskomponenter og er inkludert i software development kit (SDK).</span><span class="sxs-lookup"><span data-stu-id="585f9-113">A fiscal integration sample consists of several extensions of Commerce components and is included in the software development kit (SDK).</span></span> <span data-ttu-id="585f9-114">Hvis du vil ha mer informasjon om eksemplene på regnskapsintegrering, kan du se [Eksempler på regnskapsintegrering i SDK for Retail](#fiscal-integration-samples-in-the-retail-sdk).</span><span class="sxs-lookup"><span data-stu-id="585f9-114">For more information about the fiscal integration samples, see [Fiscal integration samples in the Retail SDK](#fiscal-integration-samples-in-the-retail-sdk).</span></span> <span data-ttu-id="585f9-115">Hvis du vil ha informasjon om hvordan du installerer og bruker Retail SDK, se [Retail SDK-arkitektur](../dev-itpro/retail-sdk/retail-sdk-overview.md).</span><span class="sxs-lookup"><span data-stu-id="585f9-115">For information about how to install and use the Retail SDK, see [Retail software development kit (SDK) architecture](../dev-itpro/retail-sdk/retail-sdk-overview.md).</span></span>

<span data-ttu-id="585f9-116">For å støtte andre scenarier som ikke støttes av et regnskapsintegreringseksempel, for å integrere Retail POS med andre regnskapsenheter eller -tjenester, eller for å oppfylle kravene til andre land eller regioner, må du enten utvide et eksisterende regnskapsintegreringseksempel eller lage et nytt eksempel ved hjelp av et eksisterende eksempel.</span><span class="sxs-lookup"><span data-stu-id="585f9-116">To support other scenarios that aren't supported by a fiscal integration sample, to integrate Retail POS with other fiscal devices or services, or to cover requirements of other countries or regions, you must either extend an existing fiscal integration sample or create a new sample by using an existing sample as an example.</span></span>

## <a name="fiscal-registration-process-and-fiscal-integration-samples-for-fiscal-devices"></a><span data-ttu-id="585f9-117">Bilagsregistreringsprosess og regnskapsintegreringseksempler for regnskapsenheter</span><span class="sxs-lookup"><span data-stu-id="585f9-117">Fiscal registration process and fiscal integration samples for fiscal devices</span></span>

<span data-ttu-id="585f9-118">En bilagsregistreringsprosess i Retail POS kan bestå av ett eller flere trinn.</span><span class="sxs-lookup"><span data-stu-id="585f9-118">A fiscal registration process in Retail POS can consist of one or more steps.</span></span> <span data-ttu-id="585f9-119">Hvert trinn omfatter bilagsregistrering av bestemte transaksjoner eller hendelser i én regnskapsenhet eller -tjeneste.</span><span class="sxs-lookup"><span data-stu-id="585f9-119">Each step involves fiscal registration of specific transactions or events in one fiscal device or service.</span></span> <span data-ttu-id="585f9-120">Følgende løsningskomponenter deltar i bilagsregistreringen i en regnskapsenhet som er koblet til en maskinvarestasjon:</span><span class="sxs-lookup"><span data-stu-id="585f9-120">The following solution components participate in the fiscal registration in a fiscal device that is connected to a Hardware station:</span></span>

- <span data-ttu-id="585f9-121">**Commerce runtime (CRT)-utvidelsen** – Denne komponenten serialiserer data fra transaksjoner/hendelser i formatet som også brukes for samhandling med regnskapsenheten, analyserer svar fra regnskapsenheten, og lagrer svarene i kanaldatabasen.</span><span class="sxs-lookup"><span data-stu-id="585f9-121">**Commerce runtime (CRT) extension** – This component serializes transaction/event data in the format that is also used for interaction with the fiscal device, parses responses from the fiscal device, and stores the responses in the channel database.</span></span> <span data-ttu-id="585f9-122">Utvidelsen definerer også bestemte transaksjoner og hendelser som skal registreres.</span><span class="sxs-lookup"><span data-stu-id="585f9-122">The extension also defines the specific transactions and events that must be registered.</span></span> <span data-ttu-id="585f9-123">Denne komponenten blir ofte referert til som en *regnskapsdokumentleverandør*.</span><span class="sxs-lookup"><span data-stu-id="585f9-123">This component is often referred to as a *fiscal document provider*.</span></span>
- <span data-ttu-id="585f9-124">**Maskinvarestasjon-utvidelsen** – Denne komponenten starter kommunikasjonen med regnskapsenheten, sender forespørsler og dirigerer kommandoer til regnskapsenheten på grunnlag av data fra transaksjonene/hendelsene som er hentet fra regnskapsdokumentet, og mottar svar fra regnskapsenheten.</span><span class="sxs-lookup"><span data-stu-id="585f9-124">**Hardware station extension** – This component initializes the communication with the fiscal device, sends requests and direct commands to the fiscal device based on the transaction/event data that is extracted from the fiscal document, and receives responses from the fiscal device.</span></span> <span data-ttu-id="585f9-125">Denne komponenten blir ofte referert til som en *regnskapskobling*.</span><span class="sxs-lookup"><span data-stu-id="585f9-125">This component is often referred to as a *fiscal connector*.</span></span>

<span data-ttu-id="585f9-126">Et eksempel på regnskapsintegrering for en regnskapsenhet inneholder henholdsvis CRT- og maskinvarestasjonstilleggene for en regnskapsdokumentleverandør og en regnskapskobling.</span><span class="sxs-lookup"><span data-stu-id="585f9-126">A fiscal integration sample for a fiscal device contains the CRT and Hardware station extensions for a fiscal document provider and a fiscal connector, respectively.</span></span> <span data-ttu-id="585f9-127">Det inneholder også følgende komponentkonfigurasjoner:</span><span class="sxs-lookup"><span data-stu-id="585f9-127">It also contains the following component configurations:</span></span>

- <span data-ttu-id="585f9-128">**Konfigurasjon av regnskapsdokumentleverandør** – Denne konfigurasjonen definerer en utdatametode og et format for regnskapsdokumenter.</span><span class="sxs-lookup"><span data-stu-id="585f9-128">**Fiscal document provider configuration** – This configuration defines an output method and a format for fiscal documents.</span></span> <span data-ttu-id="585f9-129">Den inneholder også en datatilordning for avgifter og betalingsmåter for å gjøre data fra Retail POS kompatible med verdiene som er forhåndsdefinert i fastvaren til regnskapsenheten.</span><span class="sxs-lookup"><span data-stu-id="585f9-129">It also contains a data mapping for taxes and payment methods, to make data from Retail POS compatible with the values that are predefined in the fiscal device firmware.</span></span>
- <span data-ttu-id="585f9-130">**Konfigurasjon av regnskapskobling** – Denne konfigurasjonen definerer den fysiske kommunikasjonen med en bestemt regnskapsenhet.</span><span class="sxs-lookup"><span data-stu-id="585f9-130">**Fiscal connector configuration** – This configuration defines the physical communication with the specific fiscal device.</span></span>

<span data-ttu-id="585f9-131">En bilagsregistreringsprosess for en bestemt salgsstedskasse er definert av en tilsvarende innstilling i funksjonalitetsprofilen for salgsstedet.</span><span class="sxs-lookup"><span data-stu-id="585f9-131">A fiscal registration process for a specific POS register is defined by a corresponding setting in the POS functionality profile.</span></span> <span data-ttu-id="585f9-132">Hvis du vil ha mer informasjon om hvordan du konfigurerer en bilagsregistreringsprosess, laster opp konfigurasjoner for regnskapsdokumentleverandører og regnskapskoblinger, og endrer parameterne, se [Konfigurere en bilagsregistreringsprosess](setting-up-fiscal-integration-for-retail-channel.md#set-up-a-fiscal-registration-process).</span><span class="sxs-lookup"><span data-stu-id="585f9-132">For more details about how to configure a fiscal registration process, upload fiscal document provider and fiscal connector configurations, and change their parameters, see [Set up a fiscal registration process](setting-up-fiscal-integration-for-retail-channel.md#set-up-a-fiscal-registration-process).</span></span>

<span data-ttu-id="585f9-133">Følgende eksempel viser en vanlig kjøringsflyt for bilagsregistrering for en regnskapsenhet.</span><span class="sxs-lookup"><span data-stu-id="585f9-133">The following example shows a typical fiscal registration execution flow for a fiscal device.</span></span> <span data-ttu-id="585f9-134">Flyten starter med en hendelse på salgsstedet (for eksempel fullføring av en salgstransaksjon) og implementerer følgende trinnrekkefølge:</span><span class="sxs-lookup"><span data-stu-id="585f9-134">The flow starts with an event in the POS (for example, finalization of a sales transaction) and implements the following sequence of steps:</span></span>

1. <span data-ttu-id="585f9-135">Salgsstedet ber om et regnskapsdokument fra CRT.</span><span class="sxs-lookup"><span data-stu-id="585f9-135">The POS requests a fiscal document from CRT.</span></span>
2. <span data-ttu-id="585f9-136">CRT bestemmer om den gjeldende hendelsen krever bilagsregistrering.</span><span class="sxs-lookup"><span data-stu-id="585f9-136">CRT determines whether the current event requires fiscal registration.</span></span>
3. <span data-ttu-id="585f9-137">Basert på innstillingene for bilagsregistreringsprosessen identifiserer CRT en regnskapskobling og tilsvarende regnskapsdokumentleverandør som skal brukes i bilagsregistreringen.</span><span class="sxs-lookup"><span data-stu-id="585f9-137">Based on the fiscal registration process settings, CRT identifies a fiscal connector and corresponding fiscal document provider to use for the fiscal registration.</span></span>
4. <span data-ttu-id="585f9-138">CRT kjører regnskapsdokumentleverandøren som genererer et regnskapsdokument (for eksempel et XML-dokument) som representerer transaksjonen eller hendelsen.</span><span class="sxs-lookup"><span data-stu-id="585f9-138">CRT runs the fiscal document provider that generates a fiscal document (for example, an XML document) that represents the transaction or event.</span></span>
5. <span data-ttu-id="585f9-139">POS sender regnskapsdokumentet som CRT klargjør, til en maskinvarestasjon.</span><span class="sxs-lookup"><span data-stu-id="585f9-139">The POS sends the fiscal document that CRT prepares to a Hardware station.</span></span>
6. <span data-ttu-id="585f9-140">Maskinvarestasjonen kjører regnskapskoblingen som behandler regnskapsdokumentet, og kommuniserer den til regnskapsenheten eller -tjenesten.</span><span class="sxs-lookup"><span data-stu-id="585f9-140">The Hardware station runs the fiscal connector that processes the fiscal document and communicates it to the fiscal device or service.</span></span>
7. <span data-ttu-id="585f9-141">Salgsstedet analyserer svaret fra regnskapsenheten eller -tjenesten for å bestemme om bilagsregistreringen var vellykket.</span><span class="sxs-lookup"><span data-stu-id="585f9-141">The POS analyzes the response from the fiscal device or service to determine whether the fiscal registration was successful.</span></span>
8. <span data-ttu-id="585f9-142">CRT lagrer svaret i kanaldatabasen.</span><span class="sxs-lookup"><span data-stu-id="585f9-142">CRT saves the response to the channel database.</span></span>

<span data-ttu-id="585f9-143">![Løsningsskjema](media/emea-fiscal-integration-solution.png "Løsningsskjema")</span><span class="sxs-lookup"><span data-stu-id="585f9-143">![Solution schema](media/emea-fiscal-integration-solution.png "Solution schema")</span></span>

## <a name="error-handling"></a><span data-ttu-id="585f9-144">Feilbehandling</span><span class="sxs-lookup"><span data-stu-id="585f9-144">Error handling</span></span>

<span data-ttu-id="585f9-145">Rammeverket for regnskapsintegrering har følgende alternativer for å håndtere feil under bilagsregistreringen:</span><span class="sxs-lookup"><span data-stu-id="585f9-145">The fiscal integration framework provides the following options to handle failures during fiscal registration:</span></span>

- <span data-ttu-id="585f9-146">**Prøv på nytt** – Operatører kan bruke dette alternativet når feilen kan løses raskt, og bilagsregistreringen kan kjøres på nytt.</span><span class="sxs-lookup"><span data-stu-id="585f9-146">**Retry** – Operators can use this option when the failure can be resolved quickly, and the fiscal registration can be rerun.</span></span> <span data-ttu-id="585f9-147">Dette alternativet kan for eksempel brukes når regnskapsenheten ikke er tilkoblet, bilagsskriveren er tom for papir, eller det er papirstopp i bilagsskriveren.</span><span class="sxs-lookup"><span data-stu-id="585f9-147">For example, this option can be used when the fiscal device isn't connected, the fiscal printer is out of paper, or there is a paper jam in the fiscal printer.</span></span>
- <span data-ttu-id="585f9-148">**Avbryt** – Dette alternativet lar operatører utsette bilagsregistreringen av den gjeldende transaksjonen eller hendelsen hvis den mislykkes.</span><span class="sxs-lookup"><span data-stu-id="585f9-148">**Cancel** – This option lets operators postpone the fiscal registration of the current transaction or event if it fails.</span></span> <span data-ttu-id="585f9-149">Når registreringen utsettes, kan operatøren fortsette å arbeide på salgsstedet, og kan utføre alle operasjoner som bilagsregistreringen ikke er nødvendig for.</span><span class="sxs-lookup"><span data-stu-id="585f9-149">After the registration is postponed, the operator can continue to work on the POS and can complete any operation that the fiscal registration isn't required for.</span></span> <span data-ttu-id="585f9-150">Når en hendelse som krever bilagsregistrering, skjer på salgsstedet (for eksempel en ny transaksjon åpnes), vises automatisk dialogboksen for feilhåndtering for å varsle operatøren at den forrige transaksjonen ikke ble riktig registrert, og for å gi alternativer for å håndtere feilen.</span><span class="sxs-lookup"><span data-stu-id="585f9-150">When any event that requires the fiscal registration occurs in the POS (for example, a new transaction is opened), the error handling dialog box automatically appears to notify the operator that the previous transaction wasn't correctly registered and to provide the error handling options.</span></span>
- <span data-ttu-id="585f9-151">**Hopp over** – Operatører kan bruke dette alternativet når bilagsregistreringen kan utelates ved bestemte betingelser, og det kan fortsettes med vanlige operasjoner på salgsstedet.</span><span class="sxs-lookup"><span data-stu-id="585f9-151">**Skip** – Operators can use this option when the fiscal registration can be omitted under specific conditions and regular operations can be continued on the POS.</span></span> <span data-ttu-id="585f9-152">Dette alternativet kan for eksempel brukes når en salgstransaksjon som bilagsregistreringen mislyktes for, kan registreres i en bestemt papirjournal.</span><span class="sxs-lookup"><span data-stu-id="585f9-152">For example, this option can be used when a sales transaction that the fiscal registration failed for can be registered in a special paper journal.</span></span>
- <span data-ttu-id="585f9-153">**Merk som registrert** – Operatører kan bruke dette alternativet når transaksjonen faktisk ble registrert i regnskapsenheten (for eksempel en bilagskvittering ble skrevet ut), men det oppstod en feil under lagring av regnskapssvaret i kanaldatabasen.</span><span class="sxs-lookup"><span data-stu-id="585f9-153">**Mark as registered** – Operators can use this option when the transaction was actually registered in the fiscal device (for example, a fiscal receipt was printed), but a failure occurred when the fiscal response was being saved to the channel database.</span></span>

> [!NOTE]
> <span data-ttu-id="585f9-154">Alternativene **Hopp over** og **Merk som registrert** må aktiveres i bilagsregistreringsprosessen før de brukes.</span><span class="sxs-lookup"><span data-stu-id="585f9-154">The **Skip** and **Mark as registered** options must be activated in the fiscal registration process before they are used.</span></span> <span data-ttu-id="585f9-155">I tillegg må tilsvarende tillatelser gis til operatører.</span><span class="sxs-lookup"><span data-stu-id="585f9-155">In addition, corresponding permissions must be granted to operators.</span></span>

<span data-ttu-id="585f9-156">Alternativene **Hopp over** og **Merk som registrert** gjør at informasjonskoder kan hente bestemt informasjon om feilen, for eksempel årsaken til feilen eller en begrunnelse for å hoppe over bilagsregistreringen eller merke transaksjonen som registrert.</span><span class="sxs-lookup"><span data-stu-id="585f9-156">The **Skip** and **Mark as registered** options enable info codes to capture some specific information about the failure, such as the reason for the failure or a justification for skipping the fiscal registration or marking the transaction as registered.</span></span> <span data-ttu-id="585f9-157">Hvis du vil ha mer informasjon om hvordan du definerer parametere for feilbehandling, se [Konfigurere innstillinger for feilbehandling](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="585f9-157">For more details about how to set up error handling parameters, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

### <a name="optional-fiscal-registration"></a><span data-ttu-id="585f9-158">Valgfri bilagsregistrering</span><span class="sxs-lookup"><span data-stu-id="585f9-158">Optional fiscal registration</span></span>

<span data-ttu-id="585f9-159">Bilagsregistrering kan være obligatorisk for enkelte operasjoner, men valgfritt for andre.</span><span class="sxs-lookup"><span data-stu-id="585f9-159">Fiscal registration might be mandatory for some operations but optional for others.</span></span> <span data-ttu-id="585f9-160">For eksempel kan bilagsregistrering av vanlig salg og returer være obligatorisk, men bilagsregistrering av operasjoner som er knyttet til kundeinnbetalinger, kan være valgfritt.</span><span class="sxs-lookup"><span data-stu-id="585f9-160">For example, the fiscal registration of regular sales and returns might be mandatory, but the fiscal registration of operations that are related to customer deposits might be optional.</span></span> <span data-ttu-id="585f9-161">I dette tilfellet skal manglende fullføring av bilagsregistrering av salg blokkere videre salg, men manglende fullføring av bilagsregistrering for en kundeinnbetaling skal ikke blokkere videre salg.</span><span class="sxs-lookup"><span data-stu-id="585f9-161">In this case, failure to complete the fiscal registration of a sale should block further sales, but failure to complete the fiscal registration of a customer deposit should not block further sales.</span></span> <span data-ttu-id="585f9-162">For å skille mellom obligatoriske og valgfrie operasjoner anbefales det å håndtere dem gjennom ulike dokumentleverandører, og du bør definere separate trinn i bilagsregistreringsprosessen for disse leverandørene.</span><span class="sxs-lookup"><span data-stu-id="585f9-162">To distinguish mandatory and optional operations, we recommend that you handle them through different document providers, and that you set up separate steps in the fiscal registration process for those providers.</span></span> <span data-ttu-id="585f9-163">Parameteren **Fortsett ved feil** skal aktiveres for alle trinn som er knyttet til valgfri bilagsregistrering.</span><span class="sxs-lookup"><span data-stu-id="585f9-163">The **Continue on error** parameter should be enabled for any step that is related to optional fiscal registration.</span></span> <span data-ttu-id="585f9-164">Hvis du vil ha mer informasjon om hvordan du definerer parametere for feilbehandling, se [Konfigurere innstillinger for feilbehandling](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="585f9-164">For more details about how to set up error handling parameters, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

### <a name="manually-running-fiscal-registration"></a><span data-ttu-id="585f9-165">Kjøre bilagsregistrering manuelt</span><span class="sxs-lookup"><span data-stu-id="585f9-165">Manually running fiscal registration</span></span>

<span data-ttu-id="585f9-166">Hvis bilagsregistrering av en transaksjon eller hendelse er utsatt etter en feil (for eksempel hvis operatoren valgte **Avbryt** i dialogboksen for feilbehandling), kan du kjøre bilagsregistreringen på nytt manuelt ved å bruke en tilsvarende operasjon.</span><span class="sxs-lookup"><span data-stu-id="585f9-166">If the fiscal registration of a transaction or event has been postponed after a failure (for example, if the operator selected **Cancel** in the error handling dialog box), you can manually rerun the fiscal registration by invoking a corresponding operation.</span></span> <span data-ttu-id="585f9-167">Hvis du vil ha mer informasjon, se [Aktivere manuell kjøring av utsatt bilagsregistrering](setting-up-fiscal-integration-for-retail-channel.md#enable-manual-execution-of-postponed-fiscal-registration).</span><span class="sxs-lookup"><span data-stu-id="585f9-167">For more details, see [Enable manual execution of postponed fiscal registration](setting-up-fiscal-integration-for-retail-channel.md#enable-manual-execution-of-postponed-fiscal-registration).</span></span>

### <a name="fiscal-registration-health-check"></a><span data-ttu-id="585f9-168">Tilstandskontroll for bilagsregistrering</span><span class="sxs-lookup"><span data-stu-id="585f9-168">Fiscal registration health check</span></span>

<span data-ttu-id="585f9-169">Tilstandskontrollprosedyren for bilagsregistreringer kontrollerer tilgjengeligheten av regnskapsenheten eller -tjenesten når bestemte hendelser skjer.</span><span class="sxs-lookup"><span data-stu-id="585f9-169">The health check procedure for fiscal registrations verifies the availability of the fiscal device or service when specific events occur.</span></span> <span data-ttu-id="585f9-170">Hvis bilagsregistreringen ikke for øyeblikket kan fullføres, varsles operatøren på forhånd.</span><span class="sxs-lookup"><span data-stu-id="585f9-170">If the fiscal registration can't currently be completed, the operator is notified in advance.</span></span>

<span data-ttu-id="585f9-171">Salgsstedet kjører tilstandskontrollen når det oppstår følgende hendelser:</span><span class="sxs-lookup"><span data-stu-id="585f9-171">The POS runs the health check when the following events occur:</span></span>

- <span data-ttu-id="585f9-172">Det åpnes en ny transaksjon.</span><span class="sxs-lookup"><span data-stu-id="585f9-172">A new transaction is opened.</span></span>
- <span data-ttu-id="585f9-173">En suspendert transaksjon tilbakekalles.</span><span class="sxs-lookup"><span data-stu-id="585f9-173">A suspended transaction is recalled.</span></span>
- <span data-ttu-id="585f9-174">En transaksjon for salg eller retur er fullført.</span><span class="sxs-lookup"><span data-stu-id="585f9-174">A sales or return transaction is finalized.</span></span>

<span data-ttu-id="585f9-175">Hvis tilstandskontrollen mislykkes, viser salgsstedet dialogboksen for tilstandskontroll.</span><span class="sxs-lookup"><span data-stu-id="585f9-175">If the health check fails, the POS shows the health check dialog box.</span></span> <span data-ttu-id="585f9-176">Denne dialogboksen inneholder følgende knapper:</span><span class="sxs-lookup"><span data-stu-id="585f9-176">This dialog box provides the following buttons:</span></span>

- <span data-ttu-id="585f9-177">**OK** – Med denne knappen kan operatøren ignorere tilstandskontrollfeil og fortsette å behandle operasjonen.</span><span class="sxs-lookup"><span data-stu-id="585f9-177">**OK** – This button lets the operator ignore a health check error and continue to process the operation.</span></span> <span data-ttu-id="585f9-178">Operatører kan velge denne knappen hvis tillatelsen **Tillat å hoppe over tilstandskontrollfeil** er aktivert for dem.</span><span class="sxs-lookup"><span data-stu-id="585f9-178">Operators can select this button only if the **Allow skip health check error** permission is enabled for them.</span></span>
- <span data-ttu-id="585f9-179">**Avbryt** – Hvis operatøren velger denne knappen, avbryter salgsstedet siste handling (for eksempel når en vare ikke er lagt til en ny transaksjon).</span><span class="sxs-lookup"><span data-stu-id="585f9-179">**Cancel** – If the operator selects this button, the POS cancels the last action (for example, an item isn't added to a new transaction).</span></span>

> [!NOTE]
> <span data-ttu-id="585f9-180">Tilstandskontrollen kjøres bare hvis den gjeldende operasjonen krever bilagsregistrering, og hvis parameteren **Fortsett ved feil** er deaktivert for gjeldende trinn i bilagsregistreringsprosessen.</span><span class="sxs-lookup"><span data-stu-id="585f9-180">The health check is run only if the current operation requires fiscal registration, and if  the **Continue on error** parameter is disabled for the current step of the fiscal registration process.</span></span> <span data-ttu-id="585f9-181">Hvis du vil ha mer informasjon, se [Angi innstillinger for feilbehandling](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="585f9-181">For more details, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

## <a name="storing-fiscal-response-in-fiscal-transaction"></a><span data-ttu-id="585f9-182">Lagre regnskapssvar i regnskapstransaksjon</span><span class="sxs-lookup"><span data-stu-id="585f9-182">Storing fiscal response in fiscal transaction</span></span>

<span data-ttu-id="585f9-183">Når bilagsregistrering av en transaksjon eller hendelse er vellykket, opprettes en regnskapstransaksjon i kanaldatabasen og kobles til den opprinnelige transaksjonen eller hendelsen.</span><span class="sxs-lookup"><span data-stu-id="585f9-183">When fiscal registration of a transaction or event is successful, a fiscal transaction is created in the channel database and linked to the original transaction or event.</span></span> <span data-ttu-id="585f9-184">På samme måte, hvis alternativet **Hopp over** eller **Merk som registrert** er valgt for en mislykket bilagsregistrering, lagres denne informasjonen i en regnskapstransaksjon.</span><span class="sxs-lookup"><span data-stu-id="585f9-184">Similarly, if the **Skip** or **Mark as registered** option is selected for a failed fiscal registration, this information is stored in a fiscal transaction.</span></span> <span data-ttu-id="585f9-185">En regnskapstransaksjon inneholder regnskapssvaret for regnskapsenheten eller -tjenesten.</span><span class="sxs-lookup"><span data-stu-id="585f9-185">A fiscal transaction holds the fiscal response of the fiscal device or service.</span></span> <span data-ttu-id="585f9-186">Hvis bilagsregistreringsprosessen består av flere trinn, opprettes en regnskapstransaksjon for hvert trinn i prosessen som resulterte i en vellykket eller mislykket registrering.</span><span class="sxs-lookup"><span data-stu-id="585f9-186">If the fiscal registration process consists of several steps, a fiscal transaction is created for each step of the process that resulted in a successful or failed registration.</span></span>

<span data-ttu-id="585f9-187">Regnskapstransaksjoner overføres til hovedkontoret av *P-jobb* sammen med transaksjoner.</span><span class="sxs-lookup"><span data-stu-id="585f9-187">Fiscal transactions are transferred to Headquarters by the *P-job*, together with transactions.</span></span> <span data-ttu-id="585f9-188">I hurtigfanen **Regnskapstransaksjoner** på siden **Butikktransaksjoner** kan du vise regnskapstransaksjonene som er koblet til transaksjoner.</span><span class="sxs-lookup"><span data-stu-id="585f9-188">On the **Fiscal transactions** FastTab of the **Store transactions** page, you can view the fiscal transactions that are linked to transactions.</span></span>

<span data-ttu-id="585f9-189">En regnskapstransaksjon lagrer følgende detaljer:</span><span class="sxs-lookup"><span data-stu-id="585f9-189">A fiscal transaction stores the following details:</span></span>

- <span data-ttu-id="585f9-190">Detaljer om bilagsregistreringsprosessen (prosess, koblingsgruppe, kobling og så videre).</span><span class="sxs-lookup"><span data-stu-id="585f9-190">Fiscal registration process details (process, connector group, connector, and so on).</span></span> <span data-ttu-id="585f9-191">Den lagrer også serienummeret til regnskapsenheten i **Registernummer**-feltet, hvis denne informasjonen er inkludert i regnskapssvaret.</span><span class="sxs-lookup"><span data-stu-id="585f9-191">It also stores the serial number of the fiscal device in the **Register number** field, if this information is included in the fiscal response.</span></span>
- <span data-ttu-id="585f9-192">Statusen for bilagsregistreringen: **Fullført** for vellykket registrering, **Hoppet over** hvis operatøren merket av for **Hopp over**-alternativet for en mislykket registrering, eller **Merket som registrert** hvis operatøren merket av for **Merk som registrert**.</span><span class="sxs-lookup"><span data-stu-id="585f9-192">The status of the fiscal registration: **Completed** for successful registration, **Skipped** if the operator selected the **Skip** option for a failed registration, or **Marked as registered** if the operator selected the **Mark as registered** option.</span></span>
- <span data-ttu-id="585f9-193">Informasjonskodetransaksjoner som er knyttet til en valgt regnskapstransaksjon.</span><span class="sxs-lookup"><span data-stu-id="585f9-193">Info code transactions that are related to a selected fiscal transaction.</span></span> <span data-ttu-id="585f9-194">Hvis du vil vise informasjonskodetransaksjonene i hurtigfanen **Finansielle transaksjoner**, velger du en regnskapstransaksjon med statusen **Hoppet over** eller **Merket som registrert**, og velger deretter **Informasjonskodetransaksjoner**.</span><span class="sxs-lookup"><span data-stu-id="585f9-194">To view the info code transactions, on the **Fiscal transactions** FastTab, select a fiscal transaction that has a status of **Skipped** or **Marked as registered**, and then select **Info code transactions**.</span></span>

## <a name="fiscal-texts-for-discounts"></a><span data-ttu-id="585f9-195">Bilagstekster for rabatter</span><span class="sxs-lookup"><span data-stu-id="585f9-195">Fiscal texts for discounts</span></span>

<span data-ttu-id="585f9-196">Noen land/områder har spesielle krav til ekstra tekst som må skrives på bilagskvitteringer når det brukes ulike typer rabatter.</span><span class="sxs-lookup"><span data-stu-id="585f9-196">Some countries or regions have special requirements about additional texts that must be printed on fiscal receipts when different kinds of discounts are applied.</span></span> <span data-ttu-id="585f9-197">Med funksjonen for regnskapsintegrasjon kan du definere en spesiell tekst for en rabatt som skrives etter en rabattlinje på en bilagskvittering.</span><span class="sxs-lookup"><span data-stu-id="585f9-197">The fiscal integration functionality lets you set up a special text for a discount that is printed after a discount line on a fiscal receipt.</span></span> <span data-ttu-id="585f9-198">For manuelle rabatter kan du konfigurere en bilagstekst for informasjonskoden som er angitt som **Produktrabatt**-informasjonskoden, i funksjonsprofilen for salgssted.</span><span class="sxs-lookup"><span data-stu-id="585f9-198">For manual discounts, you can configure a fiscal text for the info code that is specified as the **Product discount** info code in the POS functionality profile.</span></span> <span data-ttu-id="585f9-199">Hvis du vil ha mer informasjon om hvordan du konfigurerer bilagstekster for rabatter, se [Konfigurere bilagstekster for rabatter](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-texts-for-discounts).</span><span class="sxs-lookup"><span data-stu-id="585f9-199">For more details about how to set up fiscal texts for discounts, see [Set up fiscal texts for discounts](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-texts-for-discounts).</span></span>

## <a name="printing-fiscal-x-and-fiscal-z-reports"></a><span data-ttu-id="585f9-200">Skrive ut regnskap X- og regnskap Z-rapporter</span><span class="sxs-lookup"><span data-stu-id="585f9-200">Printing fiscal X and fiscal Z reports</span></span>

<span data-ttu-id="585f9-201">Funksjonen for regnskapsintegrasjon støtter generering av dagsoppgjørsutdrag som er spesifikke for den integrerte regnskapsenheten eller -tjenesten:</span><span class="sxs-lookup"><span data-stu-id="585f9-201">Fiscal integration functionality supports generation of end-of-day statements that are specific to the integrated fiscal device or service:</span></span>

- <span data-ttu-id="585f9-202">Nye knapper som utfører tilsvarende operasjoner, må legges til skjermoppsettet for salgssted.</span><span class="sxs-lookup"><span data-stu-id="585f9-202">New buttons that run corresponding operations should be added to the POS screen layout.</span></span> <span data-ttu-id="585f9-203">Hvis du vil ha mer informasjon, se [Konfigurere X-/Z-regnskapsrapporter fra salgsstedet](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-xz-reports-from-the-pos).</span><span class="sxs-lookup"><span data-stu-id="585f9-203">For more details, see [Set up fiscal X/Z reports from the POS](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-xz-reports-from-the-pos).</span></span>
- <span data-ttu-id="585f9-204">I regnskapsintegreringseksemplet må disse operasjonene samsvares med tilsvarende operasjoner i regnskapsenheten.</span><span class="sxs-lookup"><span data-stu-id="585f9-204">In the fiscal integration sample, these operations should be matched to the corresponding operations of the fiscal device.</span></span>

## <a name="fiscal-integration-samples-in-the-retail-sdk"></a><span data-ttu-id="585f9-205">Eksempler på regnskapsintegrering i SDK for detaljhandel</span><span class="sxs-lookup"><span data-stu-id="585f9-205">Fiscal integration samples in the Retail SDK</span></span>

<span data-ttu-id="585f9-206">Følgende eksempler på regnskapsintegrering er for øyeblikket tilgjengelige i SDK for Retail:</span><span class="sxs-lookup"><span data-stu-id="585f9-206">The following fiscal integration samples are currently available in the Retail SDK:</span></span>

- [<span data-ttu-id="585f9-207">Eksempel på integrering av bilagsskriver for Italia</span><span class="sxs-lookup"><span data-stu-id="585f9-207">Fiscal printer integration sample for Italy</span></span>](emea-ita-fpi-sample.md)
- [<span data-ttu-id="585f9-208">Eksempel på integrering av bilagsskriver for Polen</span><span class="sxs-lookup"><span data-stu-id="585f9-208">Fiscal printer integration sample for Poland</span></span>](emea-pol-fpi-sample.md)
- [<span data-ttu-id="585f9-209">Eksempel på integrering av tjenesten for avgiftsmessig transaksjon for Østerrike</span><span class="sxs-lookup"><span data-stu-id="585f9-209">Fiscal registration service integration sample for Austria</span></span>](emea-aut-fi-sample.md)
- [<span data-ttu-id="585f9-210">Eksempel på integrering av tjenesten for avgiftsmessig transaksjon for Tsjekkia</span><span class="sxs-lookup"><span data-stu-id="585f9-210">Fiscal registration service integration sample for Czech Republic</span></span>](emea-cze-fi-sample.md)
- [<span data-ttu-id="585f9-211">Eksempel på integrering med kontrollenheter for Sverige</span><span class="sxs-lookup"><span data-stu-id="585f9-211">Control unit integration sample for Sweden</span></span>](./emea-swe-fi-sample.md)
- [<span data-ttu-id="585f9-212">Eksempel på integrering av tjenesten for avgiftsmessig transaksjon for Tyskland</span><span class="sxs-lookup"><span data-stu-id="585f9-212">Fiscal registration service integration sample for Germany</span></span>](./emea-deu-fi-sample.md)

<span data-ttu-id="585f9-213">Følgende funksjon for regnskapsintegrering er også tilgjengelig i detaljhandel-SDK-et, men drar for øyeblikket ikke nytte av regnskapsintegreringsrammeverket.</span><span class="sxs-lookup"><span data-stu-id="585f9-213">The following fiscal integration functionality is also available in the Retail SDK but doesn't currently take advantage of the fiscal integration framework.</span></span> <span data-ttu-id="585f9-214">Overføring av denne funksjonaliteten til rammeverket for regnskapsintegrering er planlagt i senere oppdateringer.</span><span class="sxs-lookup"><span data-stu-id="585f9-214">Migration of this functionality to the fiscal integration framework is planned for later updates.</span></span>


- [<span data-ttu-id="585f9-215">Digital signatur for Frankrike</span><span class="sxs-lookup"><span data-stu-id="585f9-215">Digital signature for France</span></span>](emea-fra-cash-registers.md)
- [<span data-ttu-id="585f9-216">Digital signatur for Norge</span><span class="sxs-lookup"><span data-stu-id="585f9-216">Digital signature for Norway</span></span>](emea-nor-cash-registers.md)

<span data-ttu-id="585f9-217">Følgende eldre funksjonalitet for økonomisk integrasjon som er tilgjengelig i Retail SDK bruker ikke rammeverket for økonomisk integrasjon og vil bli avskrevet i senere oppdateringer:</span><span class="sxs-lookup"><span data-stu-id="585f9-217">The following legacy fiscal integration functionality that is available in Retail SDK does not use the fiscal integration framework and will be deprecated in later updates:</span></span>

- [<span data-ttu-id="585f9-218">Eksempel på integrering med kontrollenheter for Sverige (eldre)</span><span class="sxs-lookup"><span data-stu-id="585f9-218">Control unit integration sample for Sweden (legacy)</span></span>](./retail-sdk-control-unit-sample.md)


[!INCLUDE[footer-include](../../includes/footer-banner.md)]